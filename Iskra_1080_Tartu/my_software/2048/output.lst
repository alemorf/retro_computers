0001   0000                 device zxspectrum48
0002   0000                org 100h
0003   0100             begin: 
0004   0100             entry: 
0005   0100             main: 
0006   0100             ; 322  main(int argc, char *argv[]) {
0007   0100             	; Stack correction reset
0008   0100 22 F5 0B    	ld (main_2_a), hl
0009   0103             
0010   0103 31 00 90    		ld sp, 9000h
0011   0106             	
0012   0106             ; 323 	asm {
0013   0106             ; 324 		ld sp, 9000h
0014   0106             ; 325 	}
0015   0106             ; 326 	char c;
0016   0106             ; 327 	bool success;
0017   0106             ; 328 
0018   0106             ; 329     // TODO: if (argc == 2 && strcmp(argv[1],"test")==0) {
0019   0106             ; 330     // TODO: 	return test();
0020   0106             ; 331     // TODO: }
0021   0106             ; 332 
0022   0106             ; 333 	initBoard();
0023   0106 CD E4 01    	call initBoard
0024   0109             l_0: 
0025   0109             ; 334 	while (true) {
0026   0109             ; 335 		c=getchar();
0027   0109 CD 3D 02    	call getchar
0028   010C 7D          	ld a, l
0029   010D 32 14 0C    	ld (main_s + 0), a
0030   0110             ; 336 		switch(c) {
0031   0110 D6 41       	sub 65
0032   0112 CA 5C 01    	jp z, l_6
0033   0115 3D          	dec a
0034   0116 CA 65 01    	jp z, l_3
0035   0119 3D          	dec a
0036   011A CA 53 01    	jp z, l_9
0037   011D 3D          	dec a
0038   011E CA 4A 01    	jp z, l_12
0039   0121 D6 1D       	sub 29
0040   0123 CA 4A 01    	jp z, l_14
0041   0126 D6 03       	sub 3
0042   0128 CA 53 01    	jp z, l_11
0043   012B D6 04       	sub 4
0044   012D CA 4A 01    	jp z, l_13
0045   0130 D6 02       	sub 2
0046   0132 CA 65 01    	jp z, l_4
0047   0135 3D          	dec a
0048   0136 CA 5C 01    	jp z, l_7
0049   0139 3D          	dec a
0050   013A CA 53 01    	jp z, l_10
0051   013D D6 07       	sub 7
0052   013F CA 65 01    	jp z, l_5
0053   0142 D6 04       	sub 4
0054   0144 CA 5C 01    	jp z, l_8
0055   0147 C3 6E 01    	jp l_15
0056   014A             l_14: 
0057   014A             l_13: 
0058   014A             l_12: 
0059   014A             ; 337 			case 97:	// 'a' key
0060   014A             ; 338 			case 104:	// 'h' key
0061   014A             ; 339 			case 68:	// left arrow
0062   014A             ; 340 				success = moveLeft();  break;
0063   014A CD 44 02    	call moveLeft
0064   014D 32 15 0C    	ld (main_s + 1), a
0065   0150 C3 72 01    	jp l_2
0066   0153             l_11: 
0067   0153             l_10: 
0068   0153             l_9: 
0069   0153             ; 341 			case 100:	// 'd' key
0070   0153             ; 342 			case 108:	// 'l' key
0071   0153             ; 343 			case 67:	// right arrow
0072   0153             ; 344 				success = moveRight(); break;
0073   0153 CD 5A 02    	call moveRight
0074   0156 32 15 0C    	ld (main_s + 1), a
0075   0159 C3 72 01    	jp l_2
0076   015C             l_8: 
0077   015C             l_7: 
0078   015C             l_6: 
0079   015C             ; 345 			case 119:	// 'w' key
0080   015C             ; 346 			case 107:	// 'k' key
0081   015C             ; 347 			case 65:	// up arrow
0082   015C             ; 348 				success = moveUp();    break;
0083   015C CD 70 02    	call moveUp
0084   015F 32 15 0C    	ld (main_s + 1), a
0085   0162 C3 72 01    	jp l_2
0086   0165             l_5: 
0087   0165             l_4: 
0088   0165             l_3: 
0089   0165             ; 349 			case 115:	// 's' key
0090   0165             ; 350 			case 106:	// 'j' key
0091   0165             ; 351 			case 66:	// down arrow
0092   0165             ; 352 				success = moveDown();  break;
0093   0165 CD A2 02    	call moveDown
0094   0168 32 15 0C    	ld (main_s + 1), a
0095   016B C3 72 01    	jp l_2
0096   016E             l_15: 
0097   016E             ; 353 			default: success = false;
0098   016E             ; 24 ;
0099   016E AF          	xor a
0100   016F 32 15 0C    	ld (main_s + 1), a
0101   0172             l_2: 
0102   0172             ; 355 ) {
0103   0172 B7          	or a
0104   0173 CA 97 01    	jp z, l_16
0105   0176             ; 356 			drawBoard();
0106   0176 CD B8 02    	call drawBoard
0107   0179             ; 357 			sleep(2);
0108   0179 21 02 00    	ld hl, 2
0109   017C CD AA 03    	call sleep
0110   017F             ; 358 			addRandom();
0111   017F CD C6 03    	call addRandom
0112   0182             ; 359 			drawBoard();
0113   0182 CD B8 02    	call drawBoard
0114   0185             ; 360 			if (gameEnded()) {
0115   0185 CD 98 04    	call gameEnded
0116   0188 B7          	or a
0117   0189 CA 97 01    	jp z, l_18
0118   018C             ; 361 				printf("            GAME OVER          \n");
0119   018C 21 38 0D    	ld hl, s_18
0120   018F E5          	push hl
0121   0190 CD CA 04    	call printf
0122   0193 C1          	pop bc
0123   0194 C3 D8 01    	jp l_1
0124   0197             l_18: 
0125   0197             l_16: 
0126   0197             ; 362 				break;
0127   0197             ; 363 			}
0128   0197             ; 364 		}
0129   0197             ; 365 		if (c=='q') {
0130   0197 3A 14 0C    	ld a, (main_s + 0)
0131   019A FE 71       	cp 113
0132   019C C2 B6 01    	jp nz, l_20
0133   019F             ; 366 			printf("            QUIT? (y/n)         \n");
0134   019F 21 59 0D    	ld hl, s_19
0135   01A2 E5          	push hl
0136   01A3 CD CA 04    	call printf
0137   01A6 C1          	pop bc
0138   01A7             ; 367 			c=getchar();
0139   01A7 CD 3D 02    	call getchar
0140   01AA 7D          	ld a, l
0141   01AB 32 14 0C    	ld (main_s + 0), a
0142   01AE             ; 368 			if (c=='y') {
0143   01AE FE 79       	cp 121
0144   01B0 CA D8 01    	jp z, l_1
0145   01B3             ; 369 				break;
0146   01B3             ; 370 			}
0147   01B3             ; 371 			prepareScreen();
0148   01B3 CD F8 04    	call prepareScreen
0149   01B6             l_20: 
0150   01B6             ; 372 		}
0151   01B6             ; 373 		if (c=='r') {
0152   01B6 3A 14 0C    	ld a, (main_s + 0)
0153   01B9 FE 72       	cp 114
0154   01BB C2 09 01    	jp nz, l_0
0155   01BE             ; 374 			printf("          RESTART? (y/n)       \n");
0156   01BE 21 7B 0D    	ld hl, s_20
0157   01C1 E5          	push hl
0158   01C2 CD CA 04    	call printf
0159   01C5 C1          	pop bc
0160   01C6             ; 375 			c=getchar();
0161   01C6 CD 3D 02    	call getchar
0162   01C9 7D          	ld a, l
0163   01CA 32 14 0C    	ld (main_s + 0), a
0164   01CD             ; 376 			if (c=='y') {
0165   01CD FE 79       	cp 121
0166   01CF CC E4 01    	call z, initBoard
0167   01D2             ; 377 				initBoard();
0168   01D2             ; 378 			}
0169   01D2             ; 379 			prepareScreen();
0170   01D2 CD F8 04    	call prepareScreen
0171   01D5 C3 09 01    	jp l_0
0172   01D8             l_1: 
0173   01D8             ; 380 		}
0174   01D8             ; 381 	}
0175   01D8             ; 382 
0176   01D8             ; 383 	printf(ESC_CLEAR_SCREEN);
0177   01D8 21 30 0D    	ld hl, s_7
0178   01DB E5          	push hl
0179   01DC CD CA 04    	call printf
0180   01DF C1          	pop bc
0181   01E0 21 00 00    	ld hl, 0
0182   01E3 C9          	ret
0183   01E4             initBoard: 
0184   01E4             ; 246  initBoard() {
0185   01E4             	; Stack correction reset
0186   01E4             ; 247 	uint8_t x,y;
0187   01E4             ; 248 	for (x=0;x<SIZE;x++) {
0188   01E4 AF          	xor a
0189   01E5 32 16 0C    	ld (initBoard_s + 0), a
0190   01E8             l_28: 
0191   01E8 3A 16 0C    	ld a, (initBoard_s + 0)
0192   01EB FE 04       	cp 4
0193   01ED D2 24 02    	jp nc, l_30
0194   01F0             ; 249 		for (y=0;y<SIZE;y++) {
0195   01F0 AF          	xor a
0196   01F1 32 17 0C    	ld (initBoard_s + 1), a
0197   01F4             l_31: 
0198   01F4 3A 17 0C    	ld a, (initBoard_s + 1)
0199   01F7 FE 04       	cp 4
0200   01F9 D2 1A 02    	jp nc, l_33
0201   01FC             ; 250 			board[x][y]=0;
0202   01FC 2A 16 0C    	ld hl, (initBoard_s + 0)
0203   01FF 26 00       	ld h, 0
0204   0201 29          	add hl, hl
0205   0202 29          	add hl, hl
0206   0203 11 D2 0B    	ld de, board
0207   0206 19          	add hl, de
0208   0207 EB          	ex hl, de
0209   0208 2A 17 0C    	ld hl, (initBoard_s + 1)
0210   020B 26 00       	ld h, 0
0211   020D 19          	add hl, de
0212   020E 36 00       	ld (hl), 0
0213   0210             l_32: 
0214   0210 3A 17 0C    	ld a, (initBoard_s + 1)
0215   0213 3C          	inc a
0216   0214 32 17 0C    	ld (initBoard_s + 1), a
0217   0217 C3 F4 01    	jp l_31
0218   021A             l_33: 
0219   021A             l_29: 
0220   021A 3A 16 0C    	ld a, (initBoard_s + 0)
0221   021D 3C          	inc a
0222   021E 32 16 0C    	ld (initBoard_s + 0), a
0223   0221 C3 E8 01    	jp l_28
0224   0224             l_30: 
0225   0224             ; 251 		}
0226   0224             ; 252 	}
0227   0224             ; 253     addRandom();
0228   0224 CD C6 03    	call addRandom
0229   0227             ; 254     addRandom();
0230   0227 CD C6 03    	call addRandom
0231   022A             ; 255     prepareScreen();
0232   022A CD F8 04    	call prepareScreen
0233   022D             ; 256     score = 0;
0234   022D 11 00 00    	ld de, 0
0235   0230 21 00 00    	ld hl, 0
0236   0233 22 CE 0B    	ld (score), hl
0237   0236 EB          	ex hl, de
0238   0237 22 D0 0B    	ld ((score) + 2), hl
0239   023A             ; 257     drawBoard();
0240   023A C3 B8 02    	jp drawBoard
0241   023D             getchar: 
0242   023D             ; 40  __fastcall getchar() {
0243   023D             	; Stack correction reset
0244   023D             ; 41     return cpmBiosConIn();
0245   023D CD BC 05    	call cpmBiosConIn
0246   0240 6F          	ld l, a
0247   0241 26 00       	ld h, 0
0248   0243 C9          	ret
0249   0244             moveLeft: 
0250   0244             ; 150  moveLeft() {
0251   0244             	; Stack correction reset
0252   0244             ; 151 	bool success;
0253   0244             ; 152 	rotateBoard();
0254   0244 CD C3 05    	call rotateBoard
0255   0247             ; 153 	success = moveUp();
0256   0247 CD 70 02    	call moveUp
0257   024A 32 18 0C    	ld (moveLeft_s + 0), a
0258   024D             ; 154 	rotateBoard();
0259   024D CD C3 05    	call rotateBoard
0260   0250             ; 155 	rotateBoard();
0261   0250 CD C3 05    	call rotateBoard
0262   0253             ; 156 	rotateBoard();
0263   0253 CD C3 05    	call rotateBoard
0264   0256             ; 157 	return success;
0265   0256 3A 18 0C    	ld a, (moveLeft_s + 0)
0266   0259 C9          	ret
0267   025A             moveRight: 
0268   025A             ; 170  moveRight() {
0269   025A             	; Stack correction reset
0270   025A             ; 171 	bool success;
0271   025A             ; 172 	rotateBoard();
0272   025A CD C3 05    	call rotateBoard
0273   025D             ; 173 	rotateBoard();
0274   025D CD C3 05    	call rotateBoard
0275   0260             ; 174 	rotateBoard();
0276   0260 CD C3 05    	call rotateBoard
0277   0263             ; 175 	success = moveUp();
0278   0263 CD 70 02    	call moveUp
0279   0266 32 19 0C    	ld (moveRight_s + 0), a
0280   0269             ; 176 	rotateBoard();
0281   0269 CD C3 05    	call rotateBoard
0282   026C             ; 177 	return success;
0283   026C 3A 19 0C    	ld a, (moveRight_s + 0)
0284   026F C9          	ret
0285   0270             moveUp: 
0286   0270             ; 141  moveUp() {
0287   0270             	; Stack correction reset
0288   0270             ; 142 	bool success = false;
0289   0270             ; 24 ;
0290   0270 AF          	xor a
0291   0271 32 1A 0C    	ld (moveUp_s + 0), a
0292   0274             ; 144 =0;x<SIZE;x++) {
0293   0274 32 1B 0C    	ld (moveUp_s + 1), a
0294   0277             l_34: 
0295   0277 3A 1B 0C    	ld a, (moveUp_s + 1)
0296   027A FE 04       	cp 4
0297   027C D2 9E 02    	jp nc, l_36
0298   027F             ; 145 		success |= slideArray(board[x]);
0299   027F 2A 1B 0C    	ld hl, (moveUp_s + 1)
0300   0282 26 00       	ld h, 0
0301   0284 29          	add hl, hl
0302   0285 29          	add hl, hl
0303   0286 11 D2 0B    	ld de, board
0304   0289 19          	add hl, de
0305   028A CD 0C 07    	call slideArray
0306   028D 21 1A 0C    	ld hl, moveUp_s + 0
0307   0290 B6          	or (hl)
0308   0291 32 1A 0C    	ld (moveUp_s + 0), a
0309   0294             l_35: 
0310   0294 3A 1B 0C    	ld a, (moveUp_s + 1)
0311   0297 3C          	inc a
0312   0298 32 1B 0C    	ld (moveUp_s + 1), a
0313   029B C3 77 02    	jp l_34
0314   029E             l_36: 
0315   029E             ; 146 	}
0316   029E             ; 147 	return success;
0317   029E 3A 1A 0C    	ld a, (moveUp_s + 0)
0318   02A1 C9          	ret
0319   02A2             moveDown: 
0320   02A2             ; 160  moveDown() {
0321   02A2             	; Stack correction reset
0322   02A2             ; 161 	bool success;
0323   02A2             ; 162 	rotateBoard();
0324   02A2 CD C3 05    	call rotateBoard
0325   02A5             ; 163 	rotateBoard();
0326   02A5 CD C3 05    	call rotateBoard
0327   02A8             ; 164 	success = moveUp();
0328   02A8 CD 70 02    	call moveUp
0329   02AB 32 1C 0C    	ld (moveDown_s + 0), a
0330   02AE             ; 165 	rotateBoard();
0331   02AE CD C3 05    	call rotateBoard
0332   02B1             ; 166 	rotateBoard();
0333   02B1 CD C3 05    	call rotateBoard
0334   02B4             ; 167 	return success;
0335   02B4 3A 1C 0C    	ld a, (moveDown_s + 0)
0336   02B7 C9          	ret
0337   02B8             drawBoard: 
0338   02B8             ; 31  drawBoard() {
0339   02B8             	; Stack correction reset
0340   02B8             ; 32 	uint8_t x,y;
0341   02B8             ; 33 	uint8_t t;
0342   02B8             ; 34     printf(ESC_HOME_CURSOR);
0343   02B8             ; 1 al.c
0344   02B8 21 33 0D    	ld hl, s_0
0345   02BB E5          	push hl
0346   02BC CD CA 04    	call printf
0347   02BF C1          	pop bc
0348   02C0             ; 36 "2048.c %23d pts",score);
0349   02C0 2A D0 0B    	ld hl, (((score) + 2))
0350   02C3 EB          	ex hl, de
0351   02C4 2A CE 0B    	ld hl, (score)
0352   02C7 D5          	push de
0353   02C8 E5          	push hl
0354   02C9 21 BD 0D    	ld hl, s_1
0355   02CC E5          	push hl
0356   02CD CD CA 04    	call printf
0357   02D0 C1          	pop bc
0358   02D1 C1          	pop bc
0359   02D2 C1          	pop bc
0360   02D3             ; 37     for (y=0;y<SIZE;y++) {
0361   02D3 AF          	xor a
0362   02D4 32 1E 0C    	ld (drawBoard_s + 1), a
0363   02D7             l_37: 
0364   02D7 3A 1E 0C    	ld a, (drawBoard_s + 1)
0365   02DA FE 04       	cp 4
0366   02DC D2 A1 03    	jp nc, l_39
0367   02DF             ; 38         printf("\n\n\n\n");
0368   02DF 21 09 0D    	ld hl, s_2
0369   02E2 E5          	push hl
0370   02E3 CD CA 04    	call printf
0371   02E6 C1          	pop bc
0372   02E7             ; 39         for (x=0;x<SIZE;x++) {
0373   02E7 AF          	xor a
0374   02E8 32 1D 0C    	ld (drawBoard_s + 0), a
0375   02EB             l_40: 
0376   02EB 3A 1D 0C    	ld a, (drawBoard_s + 0)
0377   02EE FE 04       	cp 4
0378   02F0 D2 97 03    	jp nc, l_42
0379   02F3             ; 40             if (board[x][y]!=0) {
0380   02F3 2A 1D 0C    	ld hl, (drawBoard_s + 0)
0381   02F6 26 00       	ld h, 0
0382   02F8 29          	add hl, hl
0383   02F9 29          	add hl, hl
0384   02FA 11 D2 0B    	ld de, board
0385   02FD 19          	add hl, de
0386   02FE EB          	ex hl, de
0387   02FF 2A 1E 0C    	ld hl, (drawBoard_s + 1)
0388   0302 26 00       	ld h, 0
0389   0304 19          	add hl, de
0390   0305 7E          	ld a, (hl)
0391   0306 B7          	or a
0392   0307 CA 85 03    	jp z, l_43
0393   030A             ; 41                 char s[8];
0394   030A             ; 42                 snprintf(s,8,"%u",1<<board[x][y]);
0395   030A 2A 1D 0C    	ld hl, (drawBoard_s + 0)
0396   030D 26 00       	ld h, 0
0397   030F 29          	add hl, hl
0398   0310 29          	add hl, hl
0399   0311 11 D2 0B    	ld de, board
0400   0314 19          	add hl, de
0401   0315 EB          	ex hl, de
0402   0316 2A 1E 0C    	ld hl, (drawBoard_s + 1)
0403   0319 26 00       	ld h, 0
0404   031B 19          	add hl, de
0405   031C 6E          	ld l, (hl)
0406   031D 26 00       	ld h, 0
0407   031F 11 01 00    	ld de, 1
0408   0322 EB          	ex hl, de
0409   0323 CD BD 0C    	call __o_shl_16
0410   0326 E5          	push hl
0411   0327 21 9C 0D    	ld hl, s_3
0412   032A E5          	push hl
0413   032B 21 08 00    	ld hl, 8
0414   032E E5          	push hl
0415   032F 21 20 0C    	ld hl, drawBoard_s + 3
0416   0332 E5          	push hl
0417   0333 CD F0 07    	call snprintf
0418   0336 21 08 00    	ld hl, 8
0419   0339 39          	add hl, sp
0420   033A F9          	ld sp, hl
0421   033B             ; 43                 t = 7-strlen(s);
0422   033B 21 20 0C    	ld hl, drawBoard_s + 3
0423   033E CD 2E 08    	call strlen
0424   0341 7D          	ld a, l
0425   0342 57          	ld d, a
0426   0343 3E 07       	ld a, 7
0427   0345 92          	sub d
0428   0346 32 1F 0C    	ld (drawBoard_s + 2), a
0429   0349             ; 44                 printf("|%*s%s%*s",t-t/2,"",s,t/2,"");
0430   0349 21 08 0D    	ld hl, s_5
0431   034C E5          	push hl
0432   034D 2A 1F 0C    	ld hl, (drawBoard_s + 2)
0433   0350 26 00       	ld h, 0
0434   0352 11 01 00    	ld de, 1
0435   0355 CD C4 0C    	call __o_shr_u16
0436   0358 E5          	push hl
0437   0359 21 20 0C    	ld hl, drawBoard_s + 3
0438   035C E5          	push hl
0439   035D 21 08 0D    	ld hl, s_5
0440   0360 E5          	push hl
0441   0361 2A 1F 0C    	ld hl, (drawBoard_s + 2)
0442   0364 26 00       	ld h, 0
0443   0366 11 01 00    	ld de, 1
0444   0369 CD C4 0C    	call __o_shr_u16
0445   036C EB          	ex hl, de
0446   036D 2A 1F 0C    	ld hl, (drawBoard_s + 2)
0447   0370 26 00       	ld h, 0
0448   0372 CD 6E 0C    	call __o_sub_16
0449   0375 E5          	push hl
0450   0376 21 D9 0D    	ld hl, s_4
0451   0379 E5          	push hl
0452   037A CD CA 04    	call printf
0453   037D 21 0C 00    	ld hl, 12
0454   0380 39          	add hl, sp
0455   0381 F9          	ld sp, hl
0456   0382 C3 8D 03    	jp l_44
0457   0385             l_43: 
0458   0385             ; 45             } else {
0459   0385             ; 46                 printf("|       ");
0460   0385 21 D0 0D    	ld hl, s_6
0461   0388 E5          	push hl
0462   0389 CD CA 04    	call printf
0463   038C C1          	pop bc
0464   038D             l_44: 
0465   038D             l_41: 
0466   038D 3A 1D 0C    	ld a, (drawBoard_s + 0)
0467   0390 3C          	inc a
0468   0391 32 1D 0C    	ld (drawBoard_s + 0), a
0469   0394 C3 EB 02    	jp l_40
0470   0397             l_42: 
0471   0397             l_38: 
0472   0397 3A 1E 0C    	ld a, (drawBoard_s + 1)
0473   039A 3C          	inc a
0474   039B 32 1E 0C    	ld (drawBoard_s + 1), a
0475   039E C3 D7 02    	jp l_37
0476   03A1             l_39: 
0477   03A1             ; 47             }
0478   03A1             ; 48         }
0479   03A1             ; 49     }
0480   03A1             ; 50     printf("\n\n\n\n");
0481   03A1 21 09 0D    	ld hl, s_2
0482   03A4 E5          	push hl
0483   03A5 CD CA 04    	call printf
0484   03A8 C1          	pop bc
0485   03A9 C9          	ret
0486   03AA             sleep: 
0487   03AA             ; 25  sleep(unsigned seconds) {
0488   03AA             	; Stack correction reset
0489   03AA 22 F7 0B    	ld (sleep_1_a), hl
0490   03AD             l_45: 
0491   03AD             ; 26     while (seconds != 0) {
0492   03AD 2A F7 0B    	ld hl, (sleep_1_a)
0493   03B0 7C          	ld a, h
0494   03B1 B5          	or l
0495   03B2 CA C2 03    	jp z, l_46
0496   03B5             ; 27         seconds--;
0497   03B5 2B          	dec hl
0498   03B6 22 F7 0B    	ld (sleep_1_a), hl
0499   03B9             ; 28         Delay(C8080_SECOND_DELAY);
0500   03B9 21 88 13    	ld hl, 5000
0501   03BC CD 3D 08    	call Delay
0502   03BF C3 AD 03    	jp l_45
0503   03C2             l_46: 
0504   03C2             ; 30 ;
0505   03C2 21 00 00    	ld hl, 0
0506   03C5 C9          	ret
0507   03C6             addRandom: 
0508   03C6             ; 216  addRandom() {
0509   03C6             	; Stack correction reset
0510   03C6             ; 217 	static bool initialized = false;
0511   03C6             ; 218 	uint8_t x,y;
0512   03C6             ; 219 	uint8_t r,len=0;
0513   03C6 AF          	xor a
0514   03C7 32 2B 0C    	ld (addRandom_s + 3), a
0515   03CA             ; 220 	uint8_t n,list[SIZE*SIZE][2];
0516   03CA             ; 221 
0517   03CA             ; 222 	if (!initialized) {
0518   03CA 3A E2 0B    	ld a, (initialized)
0519   03CD B7          	or a
0520   03CE C2 D6 03    	jp nz, l_47
0521   03D1             ; 223 		//srand(time(NULL));
0522   03D1             ; 224 		initialized = true;
0523   03D1             ; 25 ;
0524   03D1 3E 01       	ld a, 1
0525   03D3 32 E2 0B    	ld (initialized), a
0526   03D6             l_47: 
0527   03D6             ; 227 =0;x<SIZE;x++) {
0528   03D6 AF          	xor a
0529   03D7 32 28 0C    	ld (addRandom_s + 0), a
0530   03DA             l_49: 
0531   03DA 3A 28 0C    	ld a, (addRandom_s + 0)
0532   03DD FE 04       	cp 4
0533   03DF D2 3A 04    	jp nc, l_51
0534   03E2             ; 228 		for (y=0;y<SIZE;y++) {
0535   03E2 AF          	xor a
0536   03E3 32 29 0C    	ld (addRandom_s + 1), a
0537   03E6             l_52: 
0538   03E6 3A 29 0C    	ld a, (addRandom_s + 1)
0539   03E9 FE 04       	cp 4
0540   03EB D2 30 04    	jp nc, l_54
0541   03EE             ; 229 			if (board[x][y]==0) {
0542   03EE 2A 28 0C    	ld hl, (addRandom_s + 0)
0543   03F1 26 00       	ld h, 0
0544   03F3 29          	add hl, hl
0545   03F4 29          	add hl, hl
0546   03F5 11 D2 0B    	ld de, board
0547   03F8 19          	add hl, de
0548   03F9 EB          	ex hl, de
0549   03FA 2A 29 0C    	ld hl, (addRandom_s + 1)
0550   03FD 26 00       	ld h, 0
0551   03FF 19          	add hl, de
0552   0400 7E          	ld a, (hl)
0553   0401 B7          	or a
0554   0402 C2 26 04    	jp nz, l_55
0555   0405             ; 230 				list[len][0]=x;
0556   0405 3A 28 0C    	ld a, (addRandom_s + 0)
0557   0408 2A 2B 0C    	ld hl, (addRandom_s + 3)
0558   040B 26 00       	ld h, 0
0559   040D 29          	add hl, hl
0560   040E 11 2D 0C    	ld de, addRandom_s + 5
0561   0411 19          	add hl, de
0562   0412 77          	ld (hl), a
0563   0413             ; 231 				list[len][1]=y;
0564   0413 3A 29 0C    	ld a, (addRandom_s + 1)
0565   0416 2A 2B 0C    	ld hl, (addRandom_s + 3)
0566   0419 26 00       	ld h, 0
0567   041B 29          	add hl, hl
0568   041C 19          	add hl, de
0569   041D 23          	inc hl
0570   041E 77          	ld (hl), a
0571   041F             ; 232 				len++;
0572   041F 3A 2B 0C    	ld a, (addRandom_s + 3)
0573   0422 3C          	inc a
0574   0423 32 2B 0C    	ld (addRandom_s + 3), a
0575   0426             l_55: 
0576   0426             l_53: 
0577   0426 3A 29 0C    	ld a, (addRandom_s + 1)
0578   0429 3C          	inc a
0579   042A 32 29 0C    	ld (addRandom_s + 1), a
0580   042D C3 E6 03    	jp l_52
0581   0430             l_54: 
0582   0430             l_50: 
0583   0430 3A 28 0C    	ld a, (addRandom_s + 0)
0584   0433 3C          	inc a
0585   0434 32 28 0C    	ld (addRandom_s + 0), a
0586   0437 C3 DA 03    	jp l_49
0587   043A             l_51: 
0588   043A             ; 233 			}
0589   043A             ; 234 		}
0590   043A             ; 235 	}
0591   043A             ; 236 
0592   043A             ; 237 	if (len>0) {
0593   043A 3A 2B 0C    	ld a, (addRandom_s + 3)
0594   043D B7          	or a
0595   043E C8          	ret z
0596   043F             ; 238 		r = rand()%len;
0597   043F CD 4D 08    	call rand
0598   0442 6F          	ld l, a
0599   0443 26 00       	ld h, 0
0600   0445 EB          	ex hl, de
0601   0446 2A 2B 0C    	ld hl, (addRandom_s + 3)
0602   0449 26 00       	ld h, 0
0603   044B EB          	ex hl, de
0604   044C CD B5 0C    	call __o_mod_u16
0605   044F 7D          	ld a, l
0606   0450 32 2A 0C    	ld (addRandom_s + 2), a
0607   0453             ; 239 		x = list[r][0];
0608   0453 2A 2A 0C    	ld hl, (addRandom_s + 2)
0609   0456 26 00       	ld h, 0
0610   0458 29          	add hl, hl
0611   0459 11 2D 0C    	ld de, addRandom_s + 5
0612   045C 19          	add hl, de
0613   045D 7E          	ld a, (hl)
0614   045E 32 28 0C    	ld (addRandom_s + 0), a
0615   0461             ; 240 		y = list[r][1];
0616   0461 2A 2A 0C    	ld hl, (addRandom_s + 2)
0617   0464 26 00       	ld h, 0
0618   0466 29          	add hl, hl
0619   0467 19          	add hl, de
0620   0468 23          	inc hl
0621   0469 7E          	ld a, (hl)
0622   046A 32 29 0C    	ld (addRandom_s + 1), a
0623   046D             ; 241 		n = (rand()%10)/9+1;
0624   046D CD 4D 08    	call rand
0625   0470 6F          	ld l, a
0626   0471 26 00       	ld h, 0
0627   0473 11 0A 00    	ld de, 10
0628   0476 CD B5 0C    	call __o_mod_u16
0629   0479 11 09 00    	ld de, 9
0630   047C CD 7B 0C    	call __o_div_u16
0631   047F 7D          	ld a, l
0632   0480 3C          	inc a
0633   0481 32 2C 0C    	ld (addRandom_s + 4), a
0634   0484             ; 242 		board[x][y]=n;
0635   0484 2A 28 0C    	ld hl, (addRandom_s + 0)
0636   0487 26 00       	ld h, 0
0637   0489 29          	add hl, hl
0638   048A 29          	add hl, hl
0639   048B 11 D2 0B    	ld de, board
0640   048E 19          	add hl, de
0641   048F EB          	ex hl, de
0642   0490 2A 29 0C    	ld hl, (addRandom_s + 1)
0643   0493 26 00       	ld h, 0
0644   0495 19          	add hl, de
0645   0496 77          	ld (hl), a
0646   0497 C9          	ret
0647   0498             gameEnded: 
0648   0498             ; 204  gameEnded() {
0649   0498             	; Stack correction reset
0650   0498             ; 205 	bool ended = true;
0651   0498             ; 25 ;
0652   0498 3E 01       	ld a, 1
0653   049A 32 4D 0C    	ld (gameEnded_s + 0), a
0654   049D             ; 206 )>0) return false;
0655   049D CD 58 08    	call countEmpty
0656   04A0 B7          	or a
0657   04A1 CA A6 04    	jp z, l_59
0658   04A4             ; 24 ;
0659   04A4 AF          	xor a
0660   04A5 C9          	ret
0661   04A6             l_59: 
0662   04A6             ; 207 )) return false;
0663   04A6 CD A9 08    	call findPairDown
0664   04A9 B7          	or a
0665   04AA CA AF 04    	jp z, l_61
0666   04AD             ; 24 ;
0667   04AD AF          	xor a
0668   04AE C9          	ret
0669   04AF             l_61: 
0670   04AF             ; 208 );
0671   04AF CD C3 05    	call rotateBoard
0672   04B2             ; 209 	if (findPairDown()) ended = false;
0673   04B2 CD A9 08    	call findPairDown
0674   04B5 B7          	or a
0675   04B6 CA BD 04    	jp z, l_63
0676   04B9             ; 24 ;
0677   04B9 AF          	xor a
0678   04BA 32 4D 0C    	ld (gameEnded_s + 0), a
0679   04BD             l_63: 
0680   04BD             ; 210 );
0681   04BD CD C3 05    	call rotateBoard
0682   04C0             ; 211 	rotateBoard();
0683   04C0 CD C3 05    	call rotateBoard
0684   04C3             ; 212 	rotateBoard();
0685   04C3 CD C3 05    	call rotateBoard
0686   04C6             ; 213 	return ended;
0687   04C6 3A 4D 0C    	ld a, (gameEnded_s + 0)
0688   04C9 C9          	ret
0689   04CA             printf: 
0690   04CA             ; 26  __stdcall printf(const char* format, ...) {
0691   04CA C5          	push bc
0692   04CB             	; Stack correction reset
0693   04CB             ; 1 /c8080/include/c8080/c8080.h
0694   04CB 21 06 00    	ld hl, 6
0695   04CE 39          	add hl, sp
0696   04CF EB          	ex hl, de
0697   04D0 21 00 00    	ld hl, 0
0698   04D3 39          	add hl, sp
0699   04D4 73          	ld (hl), e
0700   04D5 23          	inc hl
0701   04D6 72          	ld (hl), d
0702   04D7             ; 29  = printfOutConsole;
0703   04D7 21 09 09    	ld hl, printfOutConsole
0704   04DA 22 E3 0B    	ld (printfOut), hl
0705   04DD             ; 30     printfInternal(format, va);
0706   04DD 21 04 00    	ld hl, 4
0707   04E0 39          	add hl, sp
0708   04E1 5E          	ld e, (hl)
0709   04E2 23          	inc hl
0710   04E3 56          	ld d, (hl)
0711   04E4 EB          	ex hl, de
0712   04E5 22 FB 0B    	ld (printfInternal_1_a), hl
0713   04E8 21 00 00    	ld hl, 0
0714   04EB 39          	add hl, sp
0715   04EC 5E          	ld e, (hl)
0716   04ED 23          	inc hl
0717   04EE 56          	ld d, (hl)
0718   04EF EB          	ex hl, de
0719   04F0 CD 1B 09    	call printfInternal
0720   04F3             ; 31     va_end(va);
0721   04F3             ; 32     return printfOutTotal;
0722   04F3 2A E9 0B    	ld hl, (printfOutTotal)
0723   04F6 C1          	pop bc
0724   04F7 C9          	ret
0725   04F8             prepareScreen: 
0726   04F8             ; 53  prepareScreen() {
0727   04F8             	; Stack correction reset
0728   04F8             ; 54     uint8_t x,y,i;
0729   04F8             ; 55     printf(ESC_CLEAR_SCREEN);
0730   04F8 21 30 0D    	ld hl, s_7
0731   04FB E5          	push hl
0732   04FC CD CA 04    	call printf
0733   04FF C1          	pop bc
0734   0500             ; 57 "2048.c %17d pts\n\n",score);
0735   0500 2A D0 0B    	ld hl, (((score) + 2))
0736   0503 EB          	ex hl, de
0737   0504 2A CE 0B    	ld hl, (score)
0738   0507 D5          	push de
0739   0508 E5          	push hl
0740   0509 21 AB 0D    	ld hl, s_8
0741   050C E5          	push hl
0742   050D CD CA 04    	call printf
0743   0510 C1          	pop bc
0744   0511 C1          	pop bc
0745   0512 C1          	pop bc
0746   0513             ; 58     for (x=0;x<SIZE;x++)
0747   0513 AF          	xor a
0748   0514 32 4E 0C    	ld (prepareScreen_s + 0), a
0749   0517             l_66: 
0750   0517 3A 4E 0C    	ld a, (prepareScreen_s + 0)
0751   051A FE 04       	cp 4
0752   051C D2 31 05    	jp nc, l_68
0753   051F             ; 59         printf("+-------");
0754   051F 21 A2 0D    	ld hl, s_9
0755   0522 E5          	push hl
0756   0523 CD CA 04    	call printf
0757   0526 C1          	pop bc
0758   0527             l_67: 
0759   0527 3A 4E 0C    	ld a, (prepareScreen_s + 0)
0760   052A 3C          	inc a
0761   052B 32 4E 0C    	ld (prepareScreen_s + 0), a
0762   052E C3 17 05    	jp l_66
0763   0531             l_68: 
0764   0531             ; 60     printf("+\n");
0765   0531 21 9F 0D    	ld hl, s_10
0766   0534 E5          	push hl
0767   0535 CD CA 04    	call printf
0768   0538 C1          	pop bc
0769   0539             ; 61     for (y=0;y<SIZE;y++) {
0770   0539 AF          	xor a
0771   053A 32 4F 0C    	ld (prepareScreen_s + 1), a
0772   053D             l_69: 
0773   053D 3A 4F 0C    	ld a, (prepareScreen_s + 1)
0774   0540 FE 04       	cp 4
0775   0542 D2 B1 05    	jp nc, l_71
0776   0545             ; 62         for (i=0;i<3;i++) {
0777   0545 AF          	xor a
0778   0546 32 50 0C    	ld (prepareScreen_s + 2), a
0779   0549             l_72: 
0780   0549 3A 50 0C    	ld a, (prepareScreen_s + 2)
0781   054C FE 03       	cp 3
0782   054E D2 81 05    	jp nc, l_74
0783   0551             ; 63             for (x=0;x<SIZE;x++)
0784   0551 AF          	xor a
0785   0552 32 4E 0C    	ld (prepareScreen_s + 0), a
0786   0555             l_75: 
0787   0555 3A 4E 0C    	ld a, (prepareScreen_s + 0)
0788   0558 FE 04       	cp 4
0789   055A D2 6F 05    	jp nc, l_77
0790   055D             ; 64                 printf("|       ");
0791   055D 21 D0 0D    	ld hl, s_6
0792   0560 E5          	push hl
0793   0561 CD CA 04    	call printf
0794   0564 C1          	pop bc
0795   0565             l_76: 
0796   0565 3A 4E 0C    	ld a, (prepareScreen_s + 0)
0797   0568 3C          	inc a
0798   0569 32 4E 0C    	ld (prepareScreen_s + 0), a
0799   056C C3 55 05    	jp l_75
0800   056F             l_77: 
0801   056F             ; 65             printf("|\n");
0802   056F 21 CD 0D    	ld hl, s_11
0803   0572 E5          	push hl
0804   0573 CD CA 04    	call printf
0805   0576 C1          	pop bc
0806   0577             l_73: 
0807   0577 3A 50 0C    	ld a, (prepareScreen_s + 2)
0808   057A 3C          	inc a
0809   057B 32 50 0C    	ld (prepareScreen_s + 2), a
0810   057E C3 49 05    	jp l_72
0811   0581             l_74: 
0812   0581             ; 66         }
0813   0581             ; 67         for (x=0;x<SIZE;x++)
0814   0581 AF          	xor a
0815   0582 32 4E 0C    	ld (prepareScreen_s + 0), a
0816   0585             l_78: 
0817   0585 3A 4E 0C    	ld a, (prepareScreen_s + 0)
0818   0588 FE 04       	cp 4
0819   058A D2 9F 05    	jp nc, l_80
0820   058D             ; 68             printf("+-------");
0821   058D 21 A2 0D    	ld hl, s_9
0822   0590 E5          	push hl
0823   0591 CD CA 04    	call printf
0824   0594 C1          	pop bc
0825   0595             l_79: 
0826   0595 3A 4E 0C    	ld a, (prepareScreen_s + 0)
0827   0598 3C          	inc a
0828   0599 32 4E 0C    	ld (prepareScreen_s + 0), a
0829   059C C3 85 05    	jp l_78
0830   059F             l_80: 
0831   059F             ; 69         printf("+\n");
0832   059F 21 9F 0D    	ld hl, s_10
0833   05A2 E5          	push hl
0834   05A3 CD CA 04    	call printf
0835   05A6 C1          	pop bc
0836   05A7             l_70: 
0837   05A7 3A 4F 0C    	ld a, (prepareScreen_s + 1)
0838   05AA 3C          	inc a
0839   05AB 32 4F 0C    	ld (prepareScreen_s + 1), a
0840   05AE C3 3D 05    	jp l_69
0841   05B1             l_71: 
0842   05B1             ; 70     }
0843   05B1             ; 71     printf("\n          w,a,s,d or r,q       \n");
0844   05B1 21 0E 0D    	ld hl, s_12
0845   05B4 E5          	push hl
0846   05B5 CD CA 04    	call printf
0847   05B8 C1          	pop bc
0848   05B9             ; 72     drawBoard();
0849   05B9 C3 B8 02    	jp drawBoard
0850   05BC             cpmBiosConIn: 
0851   05BC             ; 32  uint8_t __fastcall cpmBiosConIn() {
0852   05BC             	; Stack correction reset
0853   05BC             
0854   05BC 2A 01 00            ld hl, (1)
0855   05BF 2E 09               ld l, 09h
0856   05C1 E9                  jp hl
0857   05C2                 
0858   05C2 C9          	ret
0859   05C3             rotateBoard: 
0860   05C3             ; 127  rotateBoard() {
0861   05C3             	; Stack correction reset
0862   05C3             ; 128 	uint8_t i,j,n=SIZE;
0863   05C3             ; 1 £>ëúU
0864   05C3 3E 04       	ld a, 4
0865   05C5 32 53 0C    	ld (rotateBoard_s + 2), a
0866   05C8             ; 130 =0; i<n/2; i++) {
0867   05C8 AF          	xor a
0868   05C9 32 51 0C    	ld (rotateBoard_s + 0), a
0869   05CC             l_81: 
0870   05CC 2A 53 0C    	ld hl, (rotateBoard_s + 2)
0871   05CF 26 00       	ld h, 0
0872   05D1 11 01 00    	ld de, 1
0873   05D4 CD C4 0C    	call __o_shr_u16
0874   05D7 EB          	ex hl, de
0875   05D8 2A 51 0C    	ld hl, (rotateBoard_s + 0)
0876   05DB 26 00       	ld h, 0
0877   05DD CD 6E 0C    	call __o_sub_16
0878   05E0 D0          	ret nc
0879   05E1             ; 131 		for (j=i; j<n-i-1; j++) {
0880   05E1 3A 51 0C    	ld a, (rotateBoard_s + 0)
0881   05E4 32 52 0C    	ld (rotateBoard_s + 1), a
0882   05E7             l_84: 
0883   05E7 2A 51 0C    	ld hl, (rotateBoard_s + 0)
0884   05EA 26 00       	ld h, 0
0885   05EC EB          	ex hl, de
0886   05ED 2A 53 0C    	ld hl, (rotateBoard_s + 2)
0887   05F0 26 00       	ld h, 0
0888   05F2 CD 6E 0C    	call __o_sub_16
0889   05F5 2B          	dec hl
0890   05F6 EB          	ex hl, de
0891   05F7 2A 52 0C    	ld hl, (rotateBoard_s + 1)
0892   05FA 26 00       	ld h, 0
0893   05FC CD 6E 0C    	call __o_sub_16
0894   05FF D2 02 07    	jp nc, l_86
0895   0602             ; 132 			tmp = board[i][j];
0896   0602 2A 51 0C    	ld hl, (rotateBoard_s + 0)
0897   0605 26 00       	ld h, 0
0898   0607 29          	add hl, hl
0899   0608 29          	add hl, hl
0900   0609 11 D2 0B    	ld de, board
0901   060C 19          	add hl, de
0902   060D EB          	ex hl, de
0903   060E 2A 52 0C    	ld hl, (rotateBoard_s + 1)
0904   0611 26 00       	ld h, 0
0905   0613 19          	add hl, de
0906   0614 7E          	ld a, (hl)
0907   0615 32 54 0C    	ld (rotateBoard_s + 3), a
0908   0618             ; 133 			board[i][j] = board[j][n-i-1];
0909   0618 2A 51 0C    	ld hl, (rotateBoard_s + 0)
0910   061B 26 00       	ld h, 0
0911   061D EB          	ex hl, de
0912   061E 2A 53 0C    	ld hl, (rotateBoard_s + 2)
0913   0621 26 00       	ld h, 0
0914   0623 CD 6E 0C    	call __o_sub_16
0915   0626 2B          	dec hl
0916   0627 E5          	push hl
0917   0628 2A 52 0C    	ld hl, (rotateBoard_s + 1)
0918   062B 26 00       	ld h, 0
0919   062D 29          	add hl, hl
0920   062E 29          	add hl, hl
0921   062F 11 D2 0B    	ld de, board
0922   0632 19          	add hl, de
0923   0633 D1          	pop de
0924   0634 19          	add hl, de
0925   0635 7E          	ld a, (hl)
0926   0636 2A 51 0C    	ld hl, (rotateBoard_s + 0)
0927   0639 26 00       	ld h, 0
0928   063B 29          	add hl, hl
0929   063C 29          	add hl, hl
0930   063D 11 D2 0B    	ld de, board
0931   0640 19          	add hl, de
0932   0641 EB          	ex hl, de
0933   0642 2A 52 0C    	ld hl, (rotateBoard_s + 1)
0934   0645 26 00       	ld h, 0
0935   0647 19          	add hl, de
0936   0648 77          	ld (hl), a
0937   0649             ; 134 			board[j][n-i-1] = board[n-i-1][n-j-1];
0938   0649 2A 51 0C    	ld hl, (rotateBoard_s + 0)
0939   064C 26 00       	ld h, 0
0940   064E EB          	ex hl, de
0941   064F 2A 53 0C    	ld hl, (rotateBoard_s + 2)
0942   0652 26 00       	ld h, 0
0943   0654 CD 6E 0C    	call __o_sub_16
0944   0657 2B          	dec hl
0945   0658 E5          	push hl
0946   0659 2A 52 0C    	ld hl, (rotateBoard_s + 1)
0947   065C 26 00       	ld h, 0
0948   065E 29          	add hl, hl
0949   065F 29          	add hl, hl
0950   0660 11 D2 0B    	ld de, board
0951   0663 19          	add hl, de
0952   0664 D1          	pop de
0953   0665 19          	add hl, de
0954   0666 E5          	push hl
0955   0667 2A 52 0C    	ld hl, (rotateBoard_s + 1)
0956   066A 26 00       	ld h, 0
0957   066C EB          	ex hl, de
0958   066D 2A 53 0C    	ld hl, (rotateBoard_s + 2)
0959   0670 26 00       	ld h, 0
0960   0672 CD 6E 0C    	call __o_sub_16
0961   0675 2B          	dec hl
0962   0676 E5          	push hl
0963   0677 2A 51 0C    	ld hl, (rotateBoard_s + 0)
0964   067A 26 00       	ld h, 0
0965   067C EB          	ex hl, de
0966   067D 2A 53 0C    	ld hl, (rotateBoard_s + 2)
0967   0680 26 00       	ld h, 0
0968   0682 CD 6E 0C    	call __o_sub_16
0969   0685 2B          	dec hl
0970   0686 29          	add hl, hl
0971   0687 29          	add hl, hl
0972   0688 11 D2 0B    	ld de, board
0973   068B 19          	add hl, de
0974   068C D1          	pop de
0975   068D 19          	add hl, de
0976   068E 7E          	ld a, (hl)
0977   068F E1          	pop hl
0978   0690 77          	ld (hl), a
0979   0691             ; 135 			board[n-i-1][n-j-1] = board[n-j-1][i];
0980   0691 2A 52 0C    	ld hl, (rotateBoard_s + 1)
0981   0694 26 00       	ld h, 0
0982   0696 EB          	ex hl, de
0983   0697 2A 53 0C    	ld hl, (rotateBoard_s + 2)
0984   069A 26 00       	ld h, 0
0985   069C CD 6E 0C    	call __o_sub_16
0986   069F 2B          	dec hl
0987   06A0 E5          	push hl
0988   06A1 2A 51 0C    	ld hl, (rotateBoard_s + 0)
0989   06A4 26 00       	ld h, 0
0990   06A6 EB          	ex hl, de
0991   06A7 2A 53 0C    	ld hl, (rotateBoard_s + 2)
0992   06AA 26 00       	ld h, 0
0993   06AC CD 6E 0C    	call __o_sub_16
0994   06AF 2B          	dec hl
0995   06B0 29          	add hl, hl
0996   06B1 29          	add hl, hl
0997   06B2 11 D2 0B    	ld de, board
0998   06B5 19          	add hl, de
0999   06B6 D1          	pop de
1000   06B7 19          	add hl, de
1001   06B8 E5          	push hl
1002   06B9 2A 52 0C    	ld hl, (rotateBoard_s + 1)
1003   06BC 26 00       	ld h, 0
1004   06BE EB          	ex hl, de
1005   06BF 2A 53 0C    	ld hl, (rotateBoard_s + 2)
1006   06C2 26 00       	ld h, 0
1007   06C4 CD 6E 0C    	call __o_sub_16
1008   06C7 2B          	dec hl
1009   06C8 29          	add hl, hl
1010   06C9 29          	add hl, hl
1011   06CA 11 D2 0B    	ld de, board
1012   06CD 19          	add hl, de
1013   06CE EB          	ex hl, de
1014   06CF 2A 51 0C    	ld hl, (rotateBoard_s + 0)
1015   06D2 26 00       	ld h, 0
1016   06D4 19          	add hl, de
1017   06D5 7E          	ld a, (hl)
1018   06D6 E1          	pop hl
1019   06D7 77          	ld (hl), a
1020   06D8             ; 136 			board[n-j-1][i] = tmp;
1021   06D8 2A 52 0C    	ld hl, (rotateBoard_s + 1)
1022   06DB 26 00       	ld h, 0
1023   06DD EB          	ex hl, de
1024   06DE 2A 53 0C    	ld hl, (rotateBoard_s + 2)
1025   06E1 26 00       	ld h, 0
1026   06E3 CD 6E 0C    	call __o_sub_16
1027   06E6 2B          	dec hl
1028   06E7 29          	add hl, hl
1029   06E8 29          	add hl, hl
1030   06E9 11 D2 0B    	ld de, board
1031   06EC 19          	add hl, de
1032   06ED EB          	ex hl, de
1033   06EE 2A 51 0C    	ld hl, (rotateBoard_s + 0)
1034   06F1 26 00       	ld h, 0
1035   06F3 19          	add hl, de
1036   06F4 3A 54 0C    	ld a, (rotateBoard_s + 3)
1037   06F7 77          	ld (hl), a
1038   06F8             l_85: 
1039   06F8 3A 52 0C    	ld a, (rotateBoard_s + 1)
1040   06FB 3C          	inc a
1041   06FC 32 52 0C    	ld (rotateBoard_s + 1), a
1042   06FF C3 E7 05    	jp l_84
1043   0702             l_86: 
1044   0702             l_82: 
1045   0702 3A 51 0C    	ld a, (rotateBoard_s + 0)
1046   0705 3C          	inc a
1047   0706 32 51 0C    	ld (rotateBoard_s + 0), a
1048   0709 C3 CC 05    	jp l_81
1049   070C             slideArray: 
1050   070C             ; 99  slideArray(uint8_t array[SIZE]) {
1051   070C             	; Stack correction reset
1052   070C 22 F1 0B    	ld (slideArray_1_a), hl
1053   070F             ; 100 	bool success = false;
1054   070F             ; 24 ;
1055   070F AF          	xor a
1056   0710 32 55 0C    	ld (slideArray_s + 0), a
1057   0713             ; 101  x,t,stop=0;
1058   0713 32 58 0C    	ld (slideArray_s + 3), a
1059   0716             ; 102 
1060   0716             ; 103 	for (x=0;x<SIZE;x++) {
1061   0716 32 56 0C    	ld (slideArray_s + 1), a
1062   0719             l_87: 
1063   0719 3A 56 0C    	ld a, (slideArray_s + 1)
1064   071C FE 04       	cp 4
1065   071E D2 EC 07    	jp nc, l_89
1066   0721             ; 104 		if (array[x]!=0) {
1067   0721 2A 56 0C    	ld hl, (slideArray_s + 1)
1068   0724 26 00       	ld h, 0
1069   0726 EB          	ex hl, de
1070   0727 2A F1 0B    	ld hl, (slideArray_1_a)
1071   072A 19          	add hl, de
1072   072B 7E          	ld a, (hl)
1073   072C B7          	or a
1074   072D CA E2 07    	jp z, l_90
1075   0730             ; 105 			t = findTarget(array,x,stop);
1076   0730 2A F1 0B    	ld hl, (slideArray_1_a)
1077   0733 22 ED 0B    	ld (findTarget_1_a), hl
1078   0736 3A 56 0C    	ld a, (slideArray_s + 1)
1079   0739 32 EF 0B    	ld (findTarget_2_a), a
1080   073C 3A 58 0C    	ld a, (slideArray_s + 3)
1081   073F CD 67 0A    	call findTarget
1082   0742 32 57 0C    	ld (slideArray_s + 2), a
1083   0745             ; 106 			// if target is not original position, then move or merge
1084   0745             ; 107 			if (t!=x) {
1085   0745 3A 56 0C    	ld a, (slideArray_s + 1)
1086   0748 21 57 0C    	ld hl, slideArray_s + 2
1087   074B BE          	cp (hl)
1088   074C CA E2 07    	jp z, l_92
1089   074F             ; 108 				// if target is zero, this is a move
1090   074F             ; 109 				if (array[t]==0) {
1091   074F 2A 57 0C    	ld hl, (slideArray_s + 2)
1092   0752 26 00       	ld h, 0
1093   0754 EB          	ex hl, de
1094   0755 2A F1 0B    	ld hl, (slideArray_1_a)
1095   0758 19          	add hl, de
1096   0759 7E          	ld a, (hl)
1097   075A B7          	or a
1098   075B C2 77 07    	jp nz, l_94
1099   075E             ; 110 					array[t]=array[x];
1100   075E 2A 56 0C    	ld hl, (slideArray_s + 1)
1101   0761 26 00       	ld h, 0
1102   0763 EB          	ex hl, de
1103   0764 2A F1 0B    	ld hl, (slideArray_1_a)
1104   0767 19          	add hl, de
1105   0768 7E          	ld a, (hl)
1106   0769 2A 57 0C    	ld hl, (slideArray_s + 2)
1107   076C 26 00       	ld h, 0
1108   076E EB          	ex hl, de
1109   076F 2A F1 0B    	ld hl, (slideArray_1_a)
1110   0772 19          	add hl, de
1111   0773 77          	ld (hl), a
1112   0774 C3 D1 07    	jp l_95
1113   0777             l_94: 
1114   0777             ; 111 				} else if (array[t]==array[x]) {
1115   0777 2A 56 0C    	ld hl, (slideArray_s + 1)
1116   077A 26 00       	ld h, 0
1117   077C EB          	ex hl, de
1118   077D 2A F1 0B    	ld hl, (slideArray_1_a)
1119   0780 19          	add hl, de
1120   0781 7E          	ld a, (hl)
1121   0782 2A 57 0C    	ld hl, (slideArray_s + 2)
1122   0785 26 00       	ld h, 0
1123   0787 EB          	ex hl, de
1124   0788 2A F1 0B    	ld hl, (slideArray_1_a)
1125   078B 19          	add hl, de
1126   078C BE          	cp (hl)
1127   078D C2 D1 07    	jp nz, l_96
1128   0790             ; 112 					// merge (increase power of two)
1129   0790             ; 113 					array[t]++;
1130   0790 2A 57 0C    	ld hl, (slideArray_s + 2)
1131   0793 26 00       	ld h, 0
1132   0795 EB          	ex hl, de
1133   0796 2A F1 0B    	ld hl, (slideArray_1_a)
1134   0799 19          	add hl, de
1135   079A 7E          	ld a, (hl)
1136   079B 3C          	inc a
1137   079C 77          	ld (hl), a
1138   079D             ; 114 					// increase score
1139   079D             ; 115 					score+=(uint32_t)1<<array[t];
1140   079D 2A D0 0B    	ld hl, (((score) + 2))
1141   07A0 EB          	ex hl, de
1142   07A1 2A CE 0B    	ld hl, (score)
1143   07A4 D5          	push de
1144   07A5 E5          	push hl
1145   07A6 11 00 00    	ld de, 0
1146   07A9 21 01 00    	ld hl, 1
1147   07AC D5          	push de
1148   07AD E5          	push hl
1149   07AE 2A 57 0C    	ld hl, (slideArray_s + 2)
1150   07B1 26 00       	ld h, 0
1151   07B3 EB          	ex hl, de
1152   07B4 2A F1 0B    	ld hl, (slideArray_1_a)
1153   07B7 19          	add hl, de
1154   07B8 6E          	ld l, (hl)
1155   07B9 11 00 00    	ld de, 0
1156   07BC 62          	ld h, d
1157   07BD CD E7 0C    	call __o_shl_32
1158   07C0             	; Stack correction -4
1159   07C0 CD D1 0C    	call __o_add_32
1160   07C3             	; Stack correction -4
1161   07C3 22 CE 0B    	ld (score), hl
1162   07C6 EB          	ex hl, de
1163   07C7 22 D0 0B    	ld ((score) + 2), hl
1164   07CA             ; 116 					// set stop to avoid double merge
1165   07CA             ; 117 					stop = t+1;
1166   07CA 3A 57 0C    	ld a, (slideArray_s + 2)
1167   07CD 3C          	inc a
1168   07CE 32 58 0C    	ld (slideArray_s + 3), a
1169   07D1             l_96: 
1170   07D1             l_95: 
1171   07D1             ; 118 				}
1172   07D1             ; 119 				array[x]=0;
1173   07D1 2A 56 0C    	ld hl, (slideArray_s + 1)
1174   07D4 26 00       	ld h, 0
1175   07D6 EB          	ex hl, de
1176   07D7 2A F1 0B    	ld hl, (slideArray_1_a)
1177   07DA 19          	add hl, de
1178   07DB 36 00       	ld (hl), 0
1179   07DD             ; 120 				success = true;
1180   07DD             ; 25 ;
1181   07DD 3E 01       	ld a, 1
1182   07DF 32 55 0C    	ld (slideArray_s + 0), a
1183   07E2             l_92: 
1184   07E2             l_90: 
1185   07E2             l_88: 
1186   07E2             ; 103 ) {
1187   07E2 3A 56 0C    	ld a, (slideArray_s + 1)
1188   07E5 3C          	inc a
1189   07E6 32 56 0C    	ld (slideArray_s + 1), a
1190   07E9 C3 19 07    	jp l_87
1191   07EC             l_89: 
1192   07EC             ; 104 		if (array[x]!=0) {
1193   07EC             ; 105 			t = findTarget(array,x,stop);
1194   07EC             ; 106 			// if target is not original position, then move or merge
1195   07EC             ; 107 			if (t!=x) {
1196   07EC             ; 108 				// if target is zero, this is a move
1197   07EC             ; 109 				if (array[t]==0) {
1198   07EC             ; 110 					array[t]=array[x];
1199   07EC             ; 111 				} else if (array[t]==array[x]) {
1200   07EC             ; 112 					// merge (increase power of two)
1201   07EC             ; 113 					array[t]++;
1202   07EC             ; 114 					// increase score
1203   07EC             ; 115 					score+=(uint32_t)1<<array[t];
1204   07EC             ; 116 					// set stop to avoid double merge
1205   07EC             ; 117 					stop = t+1;
1206   07EC             ; 118 				}
1207   07EC             ; 119 				array[x]=0;
1208   07EC             ; 120 				success = true;
1209   07EC             ; 121 			}
1210   07EC             ; 122 		}
1211   07EC             ; 123 	}
1212   07EC             ; 124 	return success;
1213   07EC 3A 55 0C    	ld a, (slideArray_s + 0)
1214   07EF C9          	ret
1215   07F0             snprintf: 
1216   07F0             ; 38  __stdcall snprintf(char* buffer, size_t buffer_size, const char* format, ...) {
1217   07F0 C5          	push bc
1218   07F1             	; Stack correction reset
1219   07F1             ; 1 /c8080/include/putchar.c
1220   07F1 21 0A 00    	ld hl, 10
1221   07F4 39          	add hl, sp
1222   07F5 EB          	ex hl, de
1223   07F6 21 00 00    	ld hl, 0
1224   07F9 39          	add hl, sp
1225   07FA 73          	ld (hl), e
1226   07FB 23          	inc hl
1227   07FC 72          	ld (hl), d
1228   07FD             ; 41 buffer, buffer_size, format, va);
1229   07FD 21 04 00    	ld hl, 4
1230   0800 39          	add hl, sp
1231   0801 5E          	ld e, (hl)
1232   0802 23          	inc hl
1233   0803 56          	ld d, (hl)
1234   0804 EB          	ex hl, de
1235   0805 22 FF 0B    	ld (snprintfInternal_1_a), hl
1236   0808 21 06 00    	ld hl, 6
1237   080B 39          	add hl, sp
1238   080C 5E          	ld e, (hl)
1239   080D 23          	inc hl
1240   080E 56          	ld d, (hl)
1241   080F EB          	ex hl, de
1242   0810 22 01 0C    	ld (snprintfInternal_2_a), hl
1243   0813 21 08 00    	ld hl, 8
1244   0816 39          	add hl, sp
1245   0817 5E          	ld e, (hl)
1246   0818 23          	inc hl
1247   0819 56          	ld d, (hl)
1248   081A EB          	ex hl, de
1249   081B 22 03 0C    	ld (snprintfInternal_3_a), hl
1250   081E 21 00 00    	ld hl, 0
1251   0821 39          	add hl, sp
1252   0822 5E          	ld e, (hl)
1253   0823 23          	inc hl
1254   0824 56          	ld d, (hl)
1255   0825 EB          	ex hl, de
1256   0826 CD C3 0A    	call snprintfInternal
1257   0829             ; 42     va_end(va);
1258   0829             ; 43     return printfOutTotal;
1259   0829 2A E9 0B    	ld hl, (printfOutTotal)
1260   082C C1          	pop bc
1261   082D C9          	ret
1262   082E             strlen: 
1263   082E             ; 20  __fastcall strlen(const char string[]) {
1264   082E             	; Stack correction reset
1265   082E 22 EB 0B    	ld (strlen_1_a), hl
1266   0831             ; 21     (void)string;
1267   0831             
1268   0831 11 FF FF            ld de, -1
1269   0834 AF                  xor a
1270   0835             strlen_1: 
1271   0835 BE                  cp (hl)
1272   0836 13                  inc de
1273   0837 23                  inc hl
1274   0838 C2 35 08            jp nz, strlen_1
1275   083B EB                  ex hl, de
1276   083C                 
1277   083C C9          	ret
1278   083D             Delay: 
1279   083D             ; 22  Delay(uint16_t n) {
1280   083D             	; Stack correction reset
1281   083D 22 08 0C    	ld (Delay_1_a), hl
1282   0840             l_99: 
1283   0840             ; 23     while (--n != 0) {
1284   0840 2A 08 0C    	ld hl, (Delay_1_a)
1285   0843 2B          	dec hl
1286   0844 22 08 0C    	ld (Delay_1_a), hl
1287   0847 7C          	ld a, h
1288   0848 B5          	or l
1289   0849 C2 40 08    	jp nz, l_99
1290   084C C9          	ret
1291   084D             rand: 
1292   084D             ; 20  __fastcall rand() {
1293   084D             	; Stack correction reset
1294   084D             
1295   084D             rand_seed: 
1296   084D 3E FA               ld a, 0FAh
1297   084F 47                  ld b, a
1298   0850 87                  add a, a
1299   0851 87                  add a, a
1300   0852 80                  add a, b
1301   0853 3C                  inc a
1302   0854 32 4E 08            ld (rand_seed + 1), a
1303   0857                 
1304   0857 C9          	ret
1305   0858             countEmpty: 
1306   0858             ; 191  countEmpty() {
1307   0858             	; Stack correction reset
1308   0858             ; 192 	uint8_t x,y;
1309   0858             ; 193 	uint8_t count=0;
1310   0858 AF          	xor a
1311   0859 32 5B 0C    	ld (countEmpty_s + 2), a
1312   085C             ; 194 	for (x=0;x<SIZE;x++) {
1313   085C 32 59 0C    	ld (countEmpty_s + 0), a
1314   085F             l_101: 
1315   085F 3A 59 0C    	ld a, (countEmpty_s + 0)
1316   0862 FE 04       	cp 4
1317   0864 D2 A5 08    	jp nc, l_103
1318   0867             ; 195 		for (y=0;y<SIZE;y++) {
1319   0867 AF          	xor a
1320   0868 32 5A 0C    	ld (countEmpty_s + 1), a
1321   086B             l_104: 
1322   086B 3A 5A 0C    	ld a, (countEmpty_s + 1)
1323   086E FE 04       	cp 4
1324   0870 D2 9B 08    	jp nc, l_106
1325   0873             ; 196 			if (board[x][y]==0) {
1326   0873 2A 59 0C    	ld hl, (countEmpty_s + 0)
1327   0876 26 00       	ld h, 0
1328   0878 29          	add hl, hl
1329   0879 29          	add hl, hl
1330   087A 11 D2 0B    	ld de, board
1331   087D 19          	add hl, de
1332   087E EB          	ex hl, de
1333   087F 2A 5A 0C    	ld hl, (countEmpty_s + 1)
1334   0882 26 00       	ld h, 0
1335   0884 19          	add hl, de
1336   0885 7E          	ld a, (hl)
1337   0886 B7          	or a
1338   0887 C2 91 08    	jp nz, l_107
1339   088A             ; 197 				count++;
1340   088A 3A 5B 0C    	ld a, (countEmpty_s + 2)
1341   088D 3C          	inc a
1342   088E 32 5B 0C    	ld (countEmpty_s + 2), a
1343   0891             l_107: 
1344   0891             l_105: 
1345   0891 3A 5A 0C    	ld a, (countEmpty_s + 1)
1346   0894 3C          	inc a
1347   0895 32 5A 0C    	ld (countEmpty_s + 1), a
1348   0898 C3 6B 08    	jp l_104
1349   089B             l_106: 
1350   089B             l_102: 
1351   089B 3A 59 0C    	ld a, (countEmpty_s + 0)
1352   089E 3C          	inc a
1353   089F 32 59 0C    	ld (countEmpty_s + 0), a
1354   08A2 C3 5F 08    	jp l_101
1355   08A5             l_103: 
1356   08A5             ; 198 			}
1357   08A5             ; 199 		}
1358   08A5             ; 200 	}
1359   08A5             ; 201 	return count;
1360   08A5 3A 5B 0C    	ld a, (countEmpty_s + 2)
1361   08A8 C9          	ret
1362   08A9             findPairDown: 
1363   08A9             ; 180  findPairDown() {
1364   08A9             	; Stack correction reset
1365   08A9             ; 181 	bool success = false;
1366   08A9             ; 24 ;
1367   08A9 AF          	xor a
1368   08AA 32 5C 0C    	ld (findPairDown_s + 0), a
1369   08AD             ; 183 =0;x<SIZE;x++) {
1370   08AD 32 5D 0C    	ld (findPairDown_s + 1), a
1371   08B0             l_109: 
1372   08B0 3A 5D 0C    	ld a, (findPairDown_s + 1)
1373   08B3 FE 04       	cp 4
1374   08B5 D2 05 09    	jp nc, l_111
1375   08B8             ; 184 		for (y=0;y<SIZE-1;y++) {
1376   08B8 AF          	xor a
1377   08B9 32 5E 0C    	ld (findPairDown_s + 2), a
1378   08BC             l_112: 
1379   08BC 3A 5E 0C    	ld a, (findPairDown_s + 2)
1380   08BF FE 03       	cp 3
1381   08C1 D2 FB 08    	jp nc, l_114
1382   08C4             ; 185 			if (board[x][y]==board[x][y+1]) return true;
1383   08C4 2A 5D 0C    	ld hl, (findPairDown_s + 1)
1384   08C7 26 00       	ld h, 0
1385   08C9 29          	add hl, hl
1386   08CA 29          	add hl, hl
1387   08CB 11 D2 0B    	ld de, board
1388   08CE 19          	add hl, de
1389   08CF EB          	ex hl, de
1390   08D0 2A 5E 0C    	ld hl, (findPairDown_s + 2)
1391   08D3 26 00       	ld h, 0
1392   08D5 23          	inc hl
1393   08D6 19          	add hl, de
1394   08D7 7E          	ld a, (hl)
1395   08D8 2A 5D 0C    	ld hl, (findPairDown_s + 1)
1396   08DB 26 00       	ld h, 0
1397   08DD 29          	add hl, hl
1398   08DE 29          	add hl, hl
1399   08DF 11 D2 0B    	ld de, board
1400   08E2 19          	add hl, de
1401   08E3 EB          	ex hl, de
1402   08E4 2A 5E 0C    	ld hl, (findPairDown_s + 2)
1403   08E7 26 00       	ld h, 0
1404   08E9 19          	add hl, de
1405   08EA BE          	cp (hl)
1406   08EB C2 F1 08    	jp nz, l_115
1407   08EE             ; 25 ;
1408   08EE 3E 01       	ld a, 1
1409   08F0 C9          	ret
1410   08F1             l_115: 
1411   08F1             l_113: 
1412   08F1             ; 184 ) {
1413   08F1 3A 5E 0C    	ld a, (findPairDown_s + 2)
1414   08F4 3C          	inc a
1415   08F5 32 5E 0C    	ld (findPairDown_s + 2), a
1416   08F8 C3 BC 08    	jp l_112
1417   08FB             l_114: 
1418   08FB             l_110: 
1419   08FB 3A 5D 0C    	ld a, (findPairDown_s + 1)
1420   08FE 3C          	inc a
1421   08FF 32 5D 0C    	ld (findPairDown_s + 1), a
1422   0902 C3 B0 08    	jp l_109
1423   0905             l_111: 
1424   0905             ; 185 			if (board[x][y]==board[x][y+1]) return true;
1425   0905             ; 186 		}
1426   0905             ; 187 	}
1427   0905             ; 188 	return success;
1428   0905 3A 5C 0C    	ld a, (findPairDown_s + 0)
1429   0908 C9          	ret
1430   0909             printfOutConsole: 
1431   0909             ; 21  __stdcall printfOutConsole(int c) { // TODO: static
1432   0909             	; Stack correction reset
1433   0909             ; 22     printfOutTotal++;
1434   0909 2A E9 0B    	ld hl, (printfOutTotal)
1435   090C 23          	inc hl
1436   090D 22 E9 0B    	ld (printfOutTotal), hl
1437   0910             ; 23     return putchar(c);
1438   0910 21 02 00    	ld hl, 2
1439   0913 39          	add hl, sp
1440   0914 5E          	ld e, (hl)
1441   0915 23          	inc hl
1442   0916 56          	ld d, (hl)
1443   0917 EB          	ex hl, de
1444   0918 C3 FB 0A    	jp putchar
1445   091B             printfInternal: 
1446   091B             ; 46  printfInternal(const char* format, va_list va) {
1447   091B             	; Stack correction reset
1448   091B 22 FD 0B    	ld (printfInternal_2_a), hl
1449   091E             ; 47     printfOutTotal = 0;
1450   091E 21 00 00    	ld hl, 0
1451   0921 22 E9 0B    	ld (printfOutTotal), hl
1452   0924             l_117: 
1453   0924             ; 48     char buf[UINT16_TO_STRING_SIZE];
1454   0924             ; 49     for (;;) {
1455   0924             ; 50         uint8_t c = *format;
1456   0924 2A FB 0B    	ld hl, (printfInternal_1_a)
1457   0927 7E          	ld a, (hl)
1458   0928 32 65 0C    	ld (printfInternal_s + 6), a
1459   092B             ; 51         switch (c) {
1460   092B B7          	or a
1461   092C C8          	ret z
1462   092D D6 25       	sub 37
1463   092F CA 35 09    	jp z, l_121
1464   0932 C3 4F 0A    	jp l_123
1465   0935             l_121: 
1466   0935             ; 52             case 0:
1467   0935             ; 53                 return;
1468   0935             ; 54             case '%':
1469   0935             ; 55                 unsigned width = 0;
1470   0935 21 00 00    	ld hl, 0
1471   0938 22 66 0C    	ld (printfInternal_s + 7), hl
1472   093B             ; 56                 format++;
1473   093B 2A FB 0B    	ld hl, (printfInternal_1_a)
1474   093E 23          	inc hl
1475   093F 22 FB 0B    	ld (printfInternal_1_a), hl
1476   0942             ; 57                 c = *format;
1477   0942 7E          	ld a, (hl)
1478   0943 32 65 0C    	ld (printfInternal_s + 6), a
1479   0946             ; 58                 if (c == '*') {
1480   0946 FE 2A       	cp 42
1481   0948 C2 6A 09    	jp nz, l_124
1482   094B             ; 59                     width = va_arg(va, unsigned);
1483   094B 2A FD 0B    	ld hl, (printfInternal_2_a)
1484   094E 23          	inc hl
1485   094F 23          	inc hl
1486   0950 22 FD 0B    	ld (printfInternal_2_a), hl
1487   0953 2B          	dec hl
1488   0954 2B          	dec hl
1489   0955 5E          	ld e, (hl)
1490   0956 23          	inc hl
1491   0957 56          	ld d, (hl)
1492   0958 EB          	ex hl, de
1493   0959 22 66 0C    	ld (printfInternal_s + 7), hl
1494   095C             ; 60 ;
1495   095C 2A FB 0B    	ld hl, (printfInternal_1_a)
1496   095F 23          	inc hl
1497   0960 22 FB 0B    	ld (printfInternal_1_a), hl
1498   0963             ; 61                     c = *format;
1499   0963 7E          	ld a, (hl)
1500   0964 32 65 0C    	ld (printfInternal_s + 6), a
1501   0967 C3 A1 09    	jp l_125
1502   096A             l_124: 
1503   096A             l_126: 
1504   096A             ; 62                 } else {
1505   096A             ; 63                     while (c >= '0' && c <= '9') {
1506   096A 3A 65 0C    	ld a, (printfInternal_s + 6)
1507   096D FE 30       	cp 48
1508   096F DA A1 09    	jp c, l_127
1509   0972 3E 39       	ld a, 57
1510   0974 21 65 0C    	ld hl, printfInternal_s + 6
1511   0977 BE          	cp (hl)
1512   0978 DA A1 09    	jp c, l_127
1513   097B             ; 64                         width = width * 10 + (c - '0');
1514   097B 2A 65 0C    	ld hl, (printfInternal_s + 6)
1515   097E 26 00       	ld h, 0
1516   0980 11 D0 FF    	ld de, 65488
1517   0983 19          	add hl, de
1518   0984 E5          	push hl
1519   0985 2A 66 0C    	ld hl, (printfInternal_s + 7)
1520   0988 54          	ld d, h
1521   0989 5D          	ld e, l
1522   098A 29          	add hl, hl
1523   098B 29          	add hl, hl
1524   098C 19          	add hl, de
1525   098D 29          	add hl, hl
1526   098E D1          	pop de
1527   098F 19          	add hl, de
1528   0990 22 66 0C    	ld (printfInternal_s + 7), hl
1529   0993             ; 65                         format++;
1530   0993 2A FB 0B    	ld hl, (printfInternal_1_a)
1531   0996 23          	inc hl
1532   0997 22 FB 0B    	ld (printfInternal_1_a), hl
1533   099A             ; 66                         c = *format;
1534   099A 7E          	ld a, (hl)
1535   099B 32 65 0C    	ld (printfInternal_s + 6), a
1536   099E C3 6A 09    	jp l_126
1537   09A1             l_127: 
1538   09A1             l_125: 
1539   09A1             ; 67                     }
1540   09A1             ; 68                 }
1541   09A1             ; 69                 switch (c) {
1542   09A1 3A 65 0C    	ld a, (printfInternal_s + 6)
1543   09A4 B7          	or a
1544   09A5 C8          	ret z
1545   09A6 D6 64       	sub 100
1546   09A8 CA BD 09    	jp z, l_131
1547   09AB D6 05       	sub 5
1548   09AD CA BD 09    	jp z, l_130
1549   09B0 D6 0A       	sub 10
1550   09B2 CA 22 0A    	jp z, l_129
1551   09B5 D6 02       	sub 2
1552   09B7 CA BD 09    	jp z, l_132
1553   09BA C3 5C 0A    	jp l_120
1554   09BD             l_132: 
1555   09BD             l_131: 
1556   09BD             l_130: 
1557   09BD             ; 70                     case 0:
1558   09BD             ; 71                         return;
1559   09BD             ; 72                     case 'u':
1560   09BD             ; 73                     case 'd':
1561   09BD             ; 74                     case 'i': {
1562   09BD             ; 75                         unsigned i = va_arg(va, unsigned);
1563   09BD 2A FD 0B    	ld hl, (printfInternal_2_a)
1564   09C0 23          	inc hl
1565   09C1 23          	inc hl
1566   09C2 22 FD 0B    	ld (printfInternal_2_a), hl
1567   09C5 2B          	dec hl
1568   09C6 2B          	dec hl
1569   09C7 5E          	ld e, (hl)
1570   09C8 23          	inc hl
1571   09C9 56          	ld d, (hl)
1572   09CA EB          	ex hl, de
1573   09CB 22 68 0C    	ld (printfInternal_s + 9), hl
1574   09CE             ; 76  != 'u' && (int16_t)i < 0) {
1575   09CE 3A 65 0C    	ld a, (printfInternal_s + 6)
1576   09D1 FE 75       	cp 117
1577   09D3 CA F7 09    	jp z, l_134
1578   09D6 11 00 00    	ld de, 0
1579   09D9 CD 6E 0C    	call __o_sub_16
1580   09DC F2 F7 09    	jp p, l_134
1581   09DF             ; 77                             printfOut('-');
1582   09DF 21 2D 00    	ld hl, 45
1583   09E2 E5          	push hl
1584   09E3 2A E3 0B    	ld hl, (printfOut)
1585   09E6 CD E6 0C    	call __o_call_hl
1586   09E9 C1          	pop bc
1587   09EA             ; 78                             i = 0 - i;
1588   09EA 2A 68 0C    	ld hl, (printfInternal_s + 9)
1589   09ED 11 00 00    	ld de, 0
1590   09F0 EB          	ex hl, de
1591   09F1 CD 6E 0C    	call __o_sub_16
1592   09F4 22 68 0C    	ld (printfInternal_s + 9), hl
1593   09F7             l_134: 
1594   09F7             ; 79                         }
1595   09F7             ; 80                         char* text = Uint16ToString(buf, (uint16_t)i);
1596   09F7 21 5F 0C    	ld hl, printfInternal_s + 0
1597   09FA 22 10 0C    	ld (Uint16ToString_1_a), hl
1598   09FD 2A 68 0C    	ld hl, (printfInternal_s + 9)
1599   0A00 CD 16 0B    	call Uint16ToString
1600   0A03 22 6A 0C    	ld (printfInternal_s + 11), hl
1601   0A06             ; 81                         printSpaces(width, &buf[UINT16_TO_STRING_SIZE] - text);
1602   0A06 2A 66 0C    	ld hl, (printfInternal_s + 7)
1603   0A09 22 0C 0C    	ld (printSpaces_1_a), hl
1604   0A0C 2A 6A 0C    	ld hl, (printfInternal_s + 11)
1605   0A0F 11 65 0C    	ld de, (printfInternal_s + 0) + (6)
1606   0A12 EB          	ex hl, de
1607   0A13 CD 6E 0C    	call __o_sub_16
1608   0A16 CD 4A 0B    	call printSpaces
1609   0A19             ; 82                         printfText(text);
1610   0A19 2A 6A 0C    	ld hl, (printfInternal_s + 11)
1611   0A1C CD 80 0B    	call printfText
1612   0A1F C3 5C 0A    	jp l_120
1613   0A22             l_129: 
1614   0A22             ; 83                         break;
1615   0A22             ; 84                     }
1616   0A22             ; 85                     case 's': {
1617   0A22             ; 86                         uint16_t prevTotal = printfOutTotal;
1618   0A22 2A E9 0B    	ld hl, (printfOutTotal)
1619   0A25 22 68 0C    	ld (printfInternal_s + 9), hl
1620   0A28             ; 87                         printfText(va_arg(va, char*));
1621   0A28 2A FD 0B    	ld hl, (printfInternal_2_a)
1622   0A2B 23          	inc hl
1623   0A2C 23          	inc hl
1624   0A2D 22 FD 0B    	ld (printfInternal_2_a), hl
1625   0A30 2B          	dec hl
1626   0A31 2B          	dec hl
1627   0A32 5E          	ld e, (hl)
1628   0A33 23          	inc hl
1629   0A34 56          	ld d, (hl)
1630   0A35 EB          	ex hl, de
1631   0A36 CD 80 0B    	call printfText
1632   0A39             ; 88 width, printfOutTotal - prevTotal);
1633   0A39 2A 66 0C    	ld hl, (printfInternal_s + 7)
1634   0A3C 22 0C 0C    	ld (printSpaces_1_a), hl
1635   0A3F 2A 68 0C    	ld hl, (printfInternal_s + 9)
1636   0A42 EB          	ex hl, de
1637   0A43 2A E9 0B    	ld hl, (printfOutTotal)
1638   0A46 CD 6E 0C    	call __o_sub_16
1639   0A49 CD 4A 0B    	call printSpaces
1640   0A4C C3 5C 0A    	jp l_120
1641   0A4F             l_123: 
1642   0A4F             ; 89                         break;
1643   0A4F             ; 90                     }
1644   0A4F             ; 91                 }
1645   0A4F             ; 92                 break;
1646   0A4F             ; 93             default:
1647   0A4F             ; 94                 printfOut(c);
1648   0A4F 2A 65 0C    	ld hl, (printfInternal_s + 6)
1649   0A52 26 00       	ld h, 0
1650   0A54 E5          	push hl
1651   0A55 2A E3 0B    	ld hl, (printfOut)
1652   0A58 CD E6 0C    	call __o_call_hl
1653   0A5B C1          	pop bc
1654   0A5C             l_120: 
1655   0A5C             ; 95         }
1656   0A5C             ; 96         format++;
1657   0A5C 2A FB 0B    	ld hl, (printfInternal_1_a)
1658   0A5F 23          	inc hl
1659   0A60 22 FB 0B    	ld (printfInternal_1_a), hl
1660   0A63             l_118: 
1661   0A63 C3 24 09    	jp l_117
1662   0A66             l_119: 
1663   0A66 C9          	ret
1664   0A67             findTarget: 
1665   0A67             ; 75  findTarget(uint8_t array[SIZE],uint8_t x,uint8_t stop) {
1666   0A67             	; Stack correction reset
1667   0A67 32 F0 0B    	ld (findTarget_3_a), a
1668   0A6A             ; 76 	uint8_t t;
1669   0A6A             ; 77 	// if the position is already on the first, don't evaluate
1670   0A6A             ; 78 	if (x==0) {
1671   0A6A 3A EF 0B    	ld a, (findTarget_2_a)
1672   0A6D B7          	or a
1673   0A6E C2 72 0A    	jp nz, l_136
1674   0A71             ; 79 		return x;
1675   0A71 C9          	ret
1676   0A72             l_136: 
1677   0A72             ; 80 	}
1678   0A72             ; 81 	for(t=x-1;;t--) {
1679   0A72 3D          	dec a
1680   0A73 32 6C 0C    	ld (findTarget_s + 0), a
1681   0A76             l_138: 
1682   0A76             ; 82 		if (array[t]!=0) {
1683   0A76 2A 6C 0C    	ld hl, (findTarget_s + 0)
1684   0A79 26 00       	ld h, 0
1685   0A7B EB          	ex hl, de
1686   0A7C 2A ED 0B    	ld hl, (findTarget_1_a)
1687   0A7F 19          	add hl, de
1688   0A80 7E          	ld a, (hl)
1689   0A81 B7          	or a
1690   0A82 CA A7 0A    	jp z, l_141
1691   0A85             ; 83 			if (array[t]!=array[x]) {
1692   0A85 2A EF 0B    	ld hl, (findTarget_2_a)
1693   0A88 26 00       	ld h, 0
1694   0A8A EB          	ex hl, de
1695   0A8B 2A ED 0B    	ld hl, (findTarget_1_a)
1696   0A8E 19          	add hl, de
1697   0A8F 7E          	ld a, (hl)
1698   0A90 2A 6C 0C    	ld hl, (findTarget_s + 0)
1699   0A93 26 00       	ld h, 0
1700   0A95 EB          	ex hl, de
1701   0A96 2A ED 0B    	ld hl, (findTarget_1_a)
1702   0A99 19          	add hl, de
1703   0A9A BE          	cp (hl)
1704   0A9B CA A3 0A    	jp z, l_143
1705   0A9E             ; 84 				// merge is not possible, take next position
1706   0A9E             ; 85 				return t+1;
1707   0A9E 3A 6C 0C    	ld a, (findTarget_s + 0)
1708   0AA1 3C          	inc a
1709   0AA2 C9          	ret
1710   0AA3             l_143: 
1711   0AA3             ; 86 			}
1712   0AA3             ; 87 			return t;
1713   0AA3 3A 6C 0C    	ld a, (findTarget_s + 0)
1714   0AA6 C9          	ret
1715   0AA7             l_141: 
1716   0AA7             ; 88 		} else {
1717   0AA7             ; 89 			// we should not slide further, return this one
1718   0AA7             ; 90 			if (t==stop) {
1719   0AA7 3A F0 0B    	ld a, (findTarget_3_a)
1720   0AAA 21 6C 0C    	ld hl, findTarget_s + 0
1721   0AAD BE          	cp (hl)
1722   0AAE C2 B5 0A    	jp nz, l_145
1723   0AB1             ; 91 				return t;
1724   0AB1 3A 6C 0C    	ld a, (findTarget_s + 0)
1725   0AB4 C9          	ret
1726   0AB5             l_145: 
1727   0AB5             l_139: 
1728   0AB5 3A 6C 0C    	ld a, (findTarget_s + 0)
1729   0AB8 3D          	dec a
1730   0AB9 32 6C 0C    	ld (findTarget_s + 0), a
1731   0ABC C3 76 0A    	jp l_138
1732   0ABF             l_140: 
1733   0ABF             ; 92 			}
1734   0ABF             ; 93 		}
1735   0ABF             ; 94 	}
1736   0ABF             ; 95 	// we did not find a
1737   0ABF             ; 96 	return x;
1738   0ABF 3A EF 0B    	ld a, (findTarget_2_a)
1739   0AC2 C9          	ret
1740   0AC3             snprintfInternal: 
1741   0AC3             ; 29  void snprintfInternal(char* buffer, size_t buffer_size, const char* format, va_list va) {
1742   0AC3             	; Stack correction reset
1743   0AC3 22 05 0C    	ld (snprintfInternal_4_a), hl
1744   0AC6             ; 30     printfOut = printfOutString;
1745   0AC6 21 A3 0B    	ld hl, printfOutString
1746   0AC9 22 E3 0B    	ld (printfOut), hl
1747   0ACC             ; 31     if (buffer_size > 0) buffer_size--;
1748   0ACC 2A 01 0C    	ld hl, (snprintfInternal_2_a)
1749   0ACF 7C          	ld a, h
1750   0AD0 B5          	or l
1751   0AD1 CA D8 0A    	jp z, l_147
1752   0AD4 2B          	dec hl
1753   0AD5 22 01 0C    	ld (snprintfInternal_2_a), hl
1754   0AD8             l_147: 
1755   0AD8             ; 32     printfOutPointer = buffer;
1756   0AD8 2A FF 0B    	ld hl, (snprintfInternal_1_a)
1757   0ADB 22 E5 0B    	ld (printfOutPointer), hl
1758   0ADE             ; 33     printfOutEnd = buffer + buffer_size;
1759   0ADE 2A 01 0C    	ld hl, (snprintfInternal_2_a)
1760   0AE1 EB          	ex hl, de
1761   0AE2 2A FF 0B    	ld hl, (snprintfInternal_1_a)
1762   0AE5 19          	add hl, de
1763   0AE6 22 E7 0B    	ld (printfOutEnd), hl
1764   0AE9             ; 34     printfInternal(format, va);
1765   0AE9 2A 03 0C    	ld hl, (snprintfInternal_3_a)
1766   0AEC 22 FB 0B    	ld (printfInternal_1_a), hl
1767   0AEF 2A 05 0C    	ld hl, (snprintfInternal_4_a)
1768   0AF2 CD 1B 09    	call printfInternal
1769   0AF5             ; 35     *printfOutPointer = 0;
1770   0AF5 2A E5 0B    	ld hl, (printfOutPointer)
1771   0AF8 36 00       	ld (hl), 0
1772   0AFA C9          	ret
1773   0AFB             putchar: 
1774   0AFB             ; 45  __fastcall putchar(int c) {
1775   0AFB             	; Stack correction reset
1776   0AFB 22 F9 0B    	ld (putchar_1_a), hl
1777   0AFE             ; 46     if (c == 0x0A) cpmBiosConOut(0x0D);
1778   0AFE 11 0A 00    	ld de, 10
1779   0B01 CD 75 0C    	call __o_cmp_16
1780   0B04 C2 0C 0B    	jp nz, l_149
1781   0B07 3E 0D       	ld a, 13
1782   0B09 CD C3 0B    	call cpmBiosConOut
1783   0B0C             l_149: 
1784   0B0C             ; 47     cpmBiosConOut(c);
1785   0B0C 3A F9 0B    	ld a, (putchar_1_a)
1786   0B0F CD C3 0B    	call cpmBiosConOut
1787   0B12             ; 48     return 0;
1788   0B12 21 00 00    	ld hl, 0
1789   0B15 C9          	ret
1790   0B16             Uint16ToString: 
1791   0B16             ; 21 * Uint16ToString(char* outputBuffer, uint16_t value) {
1792   0B16             	; Stack correction reset
1793   0B16 22 12 0C    	ld (Uint16ToString_2_a), hl
1794   0B19             ; 22     outputBuffer += UINT16_TO_STRING_SIZE - 1;
1795   0B19 2A 10 0C    	ld hl, (Uint16ToString_1_a)
1796   0B1C 11 05 00    	ld de, 5
1797   0B1F 19          	add hl, de
1798   0B20 22 10 0C    	ld (Uint16ToString_1_a), hl
1799   0B23             ; 23     *outputBuffer = 0;
1800   0B23 36 00       	ld (hl), 0
1801   0B25             l_151: 
1802   0B25             ; 24     do {
1803   0B25             ; 25         value /= 10;
1804   0B25 2A 12 0C    	ld hl, (Uint16ToString_2_a)
1805   0B28 11 0A 00    	ld de, 10
1806   0B2B CD 7B 0C    	call __o_div_u16
1807   0B2E 22 12 0C    	ld (Uint16ToString_2_a), hl
1808   0B31             ; 26         --outputBuffer;
1809   0B31 2A 10 0C    	ld hl, (Uint16ToString_1_a)
1810   0B34 2B          	dec hl
1811   0B35 22 10 0C    	ld (Uint16ToString_1_a), hl
1812   0B38             ; 27         *outputBuffer = (uint8_t)__div_16_mod + '0';
1813   0B38 3A 06 0D    	ld a, (__div_16_mod)
1814   0B3B C6 30       	add 48
1815   0B3D 77          	ld (hl), a
1816   0B3E             l_152: 
1817   0B3E             ; 28     } while (value != 0);
1818   0B3E 2A 12 0C    	ld hl, (Uint16ToString_2_a)
1819   0B41 7C          	ld a, h
1820   0B42 B5          	or l
1821   0B43 C2 25 0B    	jp nz, l_151
1822   0B46             l_153: 
1823   0B46             ; 29     return outputBuffer;
1824   0B46 2A 10 0C    	ld hl, (Uint16ToString_1_a)
1825   0B49 C9          	ret
1826   0B4A             printSpaces: 
1827   0B4A             ; 37  void printSpaces(unsigned need, unsigned ready) {
1828   0B4A             	; Stack correction reset
1829   0B4A 22 0E 0C    	ld (printSpaces_2_a), hl
1830   0B4D             ; 38     if (ready >= need) return;
1831   0B4D 2A 0C 0C    	ld hl, (printSpaces_1_a)
1832   0B50 EB          	ex hl, de
1833   0B51 2A 0E 0C    	ld hl, (printSpaces_2_a)
1834   0B54 CD 6E 0C    	call __o_sub_16
1835   0B57 D0          	ret nc
1836   0B58             ; 39     need -= ready;
1837   0B58 2A 0E 0C    	ld hl, (printSpaces_2_a)
1838   0B5B EB          	ex hl, de
1839   0B5C 2A 0C 0C    	ld hl, (printSpaces_1_a)
1840   0B5F CD 6E 0C    	call __o_sub_16
1841   0B62 22 0C 0C    	ld (printSpaces_1_a), hl
1842   0B65             l_156: 
1843   0B65             ; 40     do {
1844   0B65             ; 41         printfOut(' ');
1845   0B65 21 20 00    	ld hl, 32
1846   0B68 E5          	push hl
1847   0B69 2A E3 0B    	ld hl, (printfOut)
1848   0B6C CD E6 0C    	call __o_call_hl
1849   0B6F C1          	pop bc
1850   0B70             ; 42         need--;
1851   0B70 2A 0C 0C    	ld hl, (printSpaces_1_a)
1852   0B73 2B          	dec hl
1853   0B74 22 0C 0C    	ld (printSpaces_1_a), hl
1854   0B77             l_157: 
1855   0B77             ; 43     } while(need != 0);
1856   0B77 2A 0C 0C    	ld hl, (printSpaces_1_a)
1857   0B7A 7C          	ld a, h
1858   0B7B B5          	or l
1859   0B7C C2 65 0B    	jp nz, l_156
1860   0B7F             l_158: 
1861   0B7F C9          	ret
1862   0B80             printfText: 
1863   0B80             ; 28  printfText(const char *text) {
1864   0B80             	; Stack correction reset
1865   0B80 22 0A 0C    	ld (printfText_1_a), hl
1866   0B83             l_159: 
1867   0B83             ; 29     for (;;) {
1868   0B83             ; 30         uint8_t c = *text;
1869   0B83 2A 0A 0C    	ld hl, (printfText_1_a)
1870   0B86 7E          	ld a, (hl)
1871   0B87 32 6D 0C    	ld (printfText_s + 0), a
1872   0B8A             ; 31         if (c == 0) break;
1873   0B8A B7          	or a
1874   0B8B C8          	ret z
1875   0B8C             ; 32         printfOut(c);
1876   0B8C 2A 6D 0C    	ld hl, (printfText_s + 0)
1877   0B8F 26 00       	ld h, 0
1878   0B91 E5          	push hl
1879   0B92 2A E3 0B    	ld hl, (printfOut)
1880   0B95 CD E6 0C    	call __o_call_hl
1881   0B98 C1          	pop bc
1882   0B99             ; 33         text++;
1883   0B99 2A 0A 0C    	ld hl, (printfText_1_a)
1884   0B9C 23          	inc hl
1885   0B9D 22 0A 0C    	ld (printfText_1_a), hl
1886   0BA0             l_160: 
1887   0BA0 C3 83 0B    	jp l_159
1888   0BA3             printfOutString: 
1889   0BA3             ; 21  __stdcall printfOutString(int c) { // TODO: static
1890   0BA3             	; Stack correction reset
1891   0BA3             ; 22     printfOutTotal++;
1892   0BA3 2A E9 0B    	ld hl, (printfOutTotal)
1893   0BA6 23          	inc hl
1894   0BA7 22 E9 0B    	ld (printfOutTotal), hl
1895   0BAA             ; 23     if (printfOutPointer != printfOutEnd) {
1896   0BAA 2A E7 0B    	ld hl, (printfOutEnd)
1897   0BAD EB          	ex hl, de
1898   0BAE 2A E5 0B    	ld hl, (printfOutPointer)
1899   0BB1 CD 75 0C    	call __o_cmp_16
1900   0BB4 C8          	ret z
1901   0BB5             ; 24         *printfOutPointer = c;
1902   0BB5 21 02 00    	ld hl, 2
1903   0BB8 39          	add hl, sp
1904   0BB9 7E          	ld a, (hl)
1905   0BBA 2A E5 0B    	ld hl, (printfOutPointer)
1906   0BBD 77          	ld (hl), a
1907   0BBE             ; 25         printfOutPointer++;
1908   0BBE 23          	inc hl
1909   0BBF 22 E5 0B    	ld (printfOutPointer), hl
1910   0BC2 C9          	ret
1911   0BC3             cpmBiosConOut: 
1912   0BC3             ; 36  void __fastcall cpmBiosConOut(uint8_t c) {
1913   0BC3             	; Stack correction reset
1914   0BC3 32 07 0C    	ld (cpmBiosConOut_1_a), a
1915   0BC6             
1916   0BC6 4F                  ld c, a
1917   0BC7 2A 01 00            ld hl, (1)
1918   0BCA 2E 0C               ld l, 0Ch
1919   0BCC E9                  jp hl
1920   0BCD                 
1921   0BCD C9          	ret
1922   0BCE             score: 
1923   0BCE 00 00 00 00 	dd 0
1924   0BD2             board: 
1925   0BD2 00          	ds 16
1926   0BE2             initialized: 
1927   0BE2 00          	db 0
1928   0BE3             printfOut: 
1929   0BE3 00          	ds 2
1930   0BE5             printfOutPointer: 
1931   0BE5 00          	ds 2
1932   0BE7             printfOutEnd: 
1933   0BE7 00          	ds 2
1934   0BE9             printfOutTotal: 
1935   0BE9 00          	ds 2
1936   0BEB             strlen_1_a: 
1937   0BEB 00          	ds 2
1938   0BED             findTarget_1_a: 
1939   0BED 00          	ds 2
1940   0BEF             findTarget_2_a: 
1941   0BEF 00          	ds 1
1942   0BF0             findTarget_3_a: 
1943   0BF0 00          	ds 1
1944   0BF1             slideArray_1_a: 
1945   0BF1 00          	ds 2
1946   0BF3             main_1_a: 
1947   0BF3 00          	ds 2
1948   0BF5             main_2_a: 
1949   0BF5 00          	ds 2
1950   0BF7             sleep_1_a: 
1951   0BF7 00          	ds 2
1952   0BF9             putchar_1_a: 
1953   0BF9 00          	ds 2
1954   0BFB             printfInternal_1_a: 
1955   0BFB 00          	ds 2
1956   0BFD             printfInternal_2_a: 
1957   0BFD 00          	ds 2
1958   0BFF             snprintfInternal_1_a: 
1959   0BFF 00          	ds 2
1960   0C01             snprintfInternal_2_a: 
1961   0C01 00          	ds 2
1962   0C03             snprintfInternal_3_a: 
1963   0C03 00          	ds 2
1964   0C05             snprintfInternal_4_a: 
1965   0C05 00          	ds 2
1966   0C07             cpmBiosConOut_1_a: 
1967   0C07 00          	ds 1
1968   0C08             Delay_1_a: 
1969   0C08 00          	ds 2
1970   0C0A             printfText_1_a: 
1971   0C0A 00          	ds 2
1972   0C0C             printSpaces_1_a: 
1973   0C0C 00          	ds 2
1974   0C0E             printSpaces_2_a: 
1975   0C0E 00          	ds 2
1976   0C10             Uint16ToString_1_a: 
1977   0C10 00          	ds 2
1978   0C12             Uint16ToString_2_a: 
1979   0C12 00          	ds 2
1980   0C14             main_s: 
1981   0C14 00          	ds 2
1982   0C16             initBoard_s: 
1983   0C16 00          	ds 2
1984   0C18             moveLeft_s: 
1985   0C18 00          	ds 1
1986   0C19             moveRight_s: 
1987   0C19 00          	ds 1
1988   0C1A             moveUp_s: 
1989   0C1A 00          	ds 2
1990   0C1C             moveDown_s: 
1991   0C1C 00          	ds 1
1992   0C1D             drawBoard_s: 
1993   0C1D 00          	ds 11
1994   0C28             addRandom_s: 
1995   0C28 00          	ds 37
1996   0C4D             gameEnded_s: 
1997   0C4D 00          	ds 1
1998   0C4E             prepareScreen_s: 
1999   0C4E 00          	ds 3
2000   0C51             rotateBoard_s: 
2001   0C51 00          	ds 4
2002   0C55             slideArray_s: 
2003   0C55 00          	ds 4
2004   0C59             countEmpty_s: 
2005   0C59 00          	ds 3
2006   0C5C             findPairDown_s: 
2007   0C5C 00          	ds 3
2008   0C5F             printfInternal_s: 
2009   0C5F 00          	ds 13
2010   0C6C             findTarget_s: 
2011   0C6C 00          	ds 1
2012   0C6D             printfText_s: 
2013   0C6D 00          	ds 1
2014   0C6E             __o_sub_16: 
2015   0C6E 7D              ld a, l
2016   0C6F 93              sub e
2017   0C70 6F              ld l, a
2018   0C71 7C              ld a, h
2019   0C72 9A              sbc d
2020   0C73 67              ld h, a
2021   0C74 C9              ret
2022   0C75             __o_cmp_16: 
2023   0C75 7C              ld a, h
2024   0C76 BA              cp d
2025   0C77 C0              ret nz
2026   0C78 7D              ld a, l
2027   0C79 BB              cp e
2028   0C7A C9              ret
2029   0C7B             __o_div_u16: 
2030   0C7B C5              push bc
2031   0C7C EB              ex hl, de
2032   0C7D CD 87 0C        call __o_div_u16__l0
2033   0C80 EB              ex hl, de
2034   0C81 22 06 0D        ld (__div_16_mod), hl
2035   0C84 EB              ex hl, de
2036   0C85 C1              pop bc
2037   0C86 C9              ret
2038   0C87             
2039   0C87             __o_div_u16__l0: 
2040   0C87             __o_div_u16__l: 
2041   0C87 7C              ld a, h
2042   0C88 B5              or l
2043   0C89 C8              ret z
2044   0C8A 01 00 00        ld bc, 0
2045   0C8D C5              push bc
2046   0C8E             __o_div_u16__l1: 
2047   0C8E 7B              ld a, e
2048   0C8F 95              sub l
2049   0C90 7A              ld a, d
2050   0C91 9C              sbc h
2051   0C92 DA 9A 0C        jp c, __o_div_u16__l2
2052   0C95 E5              push hl
2053   0C96 29              add hl, hl
2054   0C97 D2 8E 0C        jp nc, __o_div_u16__l1
2055   0C9A             __o_div_u16__l2: 
2056   0C9A 21 00 00        ld hl, 0
2057   0C9D             __o_div_u16__l3: 
2058   0C9D C1              pop bc
2059   0C9E 78              ld a, b
2060   0C9F B1              or c
2061   0CA0 C8              ret z
2062   0CA1 29              add hl, hl
2063   0CA2 D5              push de
2064   0CA3 7B              ld a, e
2065   0CA4 91              sub c
2066   0CA5 5F              ld e, a
2067   0CA6 7A              ld a, d
2068   0CA7 98              sbc b
2069   0CA8 57              ld d, a
2070   0CA9 DA B1 0C        jp c, __o_div_u16__l4
2071   0CAC 23              inc hl
2072   0CAD C1              pop bc
2073   0CAE C3 9D 0C        jp __o_div_u16__l3
2074   0CB1             __o_div_u16__l4: 
2075   0CB1 D1              pop de
2076   0CB2 C3 9D 0C        jp __o_div_u16__l3
2077   0CB5             __o_mod_u16: 
2078   0CB5 C5              push bc
2079   0CB6 EB              ex hl, de
2080   0CB7 CD 87 0C        call __o_div_u16__l0
2081   0CBA EB              ex hl, de
2082   0CBB C1              pop bc
2083   0CBC C9              ret
2084   0CBD             __o_shl_16: 
2085   0CBD 1C              inc e
2086   0CBE             __o_shl_16__l1: 
2087   0CBE 1D              dec e
2088   0CBF C8              ret z
2089   0CC0 29              add hl, hl
2090   0CC1 C3 BE 0C        jp __o_shl_16__l1
2091   0CC4             __o_shr_u16: 
2092   0CC4 1C              inc e
2093   0CC5             __o_shr_u16__l1: 
2094   0CC5 1D              dec e
2095   0CC6 C8              ret z
2096   0CC7 7C              ld a, h
2097   0CC8 B7              or a  ; cf = 0
2098   0CC9 1F              rra
2099   0CCA 67              ld h, a
2100   0CCB 7D              ld a, l
2101   0CCC 1F              rra
2102   0CCD 6F              ld l, a
2103   0CCE C3 C5 0C        jp __o_shr_u16__l1
2104   0CD1             ; Input: de:hl - value 1, stack - 32 bit value 2
2105   0CD1             ; Output: de:hl - result
2106   0CD1             
2107   0CD1             __o_add_32: 
2108   0CD1 44 4D           ld bc, hl ; bc = v1l
2109   0CD3 E1              pop hl ; hl = ret, stack = v2l
2110   0CD4 E3              ex (sp), hl ; hl = v2l, stack = ret
2111   0CD5 79              ld a, c
2112   0CD6 85              add l
2113   0CD7 4F              ld c, a
2114   0CD8 78              ld a, b
2115   0CD9 8C              adc h
2116   0CDA 47              ld b, a ; bc - result
2117   0CDB E1              pop hl ; hl = ret, stack = v2h
2118   0CDC E3              ex (sp), hl ; hl = v2h, stack = ret
2119   0CDD 7B              ld a, e
2120   0CDE 8D              adc l
2121   0CDF 5F              ld e, a
2122   0CE0 7A              ld a, d
2123   0CE1 8C              adc h
2124   0CE2 57              ld d, a ; de - result
2125   0CE3 60 69           ld hl, bc
2126   0CE5 C9              ret
2127   0CE6             __o_call_hl: 
2128   0CE6 E9              jp hl
2129   0CE7             ; Input: de:hl - value 1, stack - 32 bit value 2
2130   0CE7             ; Output: de:hl - result
2131   0CE7             
2132   0CE7             __o_shl_32: 
2133   0CE7 44 4D           ld bc, hl ; bc = v1l
2134   0CE9 E1              pop hl ; hl = ret, stack = v2l
2135   0CEA E3              ex (sp), hl ; hl = v2l, stack = ret
2136   0CEB 7D              ld a, l
2137   0CEC E6 1F           and 31
2138   0CEE CA 01 0D        jp z, __o_shl_32_ret
2139   0CF1             __o_shl_32_1: 
2140   0CF1 EB              ex hl, de ; de <<= 1
2141   0CF2 29              add hl, hl
2142   0CF3 EB              ex hl, de
2143   0CF4 60 69           ld hl, bc ; bc <<= 1
2144   0CF6 29              add hl, hl
2145   0CF7 44 4D           ld bc, hl
2146   0CF9 C2 FD 0C        jp nz, __o_shl_32_2 ; if (flag_c) de++;
2147   0CFC 13              inc de
2148   0CFD             __o_shl_32_2: 
2149   0CFD 3D              dec a
2150   0CFE C2 F1 0C        jp nz, __o_shl_32_1
2151   0D01             __o_shl_32_ret: 
2152   0D01 E1              pop hl ; hl = ret, stack = v2ha
2153   0D02 E3              ex (sp), hl ; hl = v2h, stack = ret
2154   0D03 60 69           ld hl, bc
2155   0D05 E9              jp hl
2156   0D06             __div_16_mod: 
2157   0D06 00          	ds 2
2158   0D08 00          s_5:  db 0
2159   0D09 0A0A0A0A00  s_2:  db 10, 10, 10, 10, 0
2160   0D0E             s_12:  db 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 119, 44, 97, 44, 115, 44, 100, 32, 111, 114, 32, 114, 44, 113, 32, 32, 32, 32, 32, 32, 32, 10, 0
2160   0D0E 0A20202020202020202020772C612C732C64206F7220722C7120202020202020
2160   0D2E 0A00
2161   0D30 1B 2A 00    s_7:  db 27, 42, 0
2162   0D33 1B3D202000  s_0:  db 27, 61, 32, 32, 0
2163   0D38             s_18:  db 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 71, 65, 77, 69, 32, 79, 86, 69, 82, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 10, 0
2163   0D38 20202020202020202020202047414D45204F564552202020202020202020200A
2163   0D58 00
2164   0D59             s_19:  db 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 81, 85, 73, 84, 63, 32, 40, 121, 47, 110, 41, 32, 32, 32, 32, 32, 32, 32, 32, 32, 10, 0
2164   0D59 202020202020202020202020515549543F2028792F6E29202020202020202020
2164   0D79 0A00
2165   0D7B             s_20:  db 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 82, 69, 83, 84, 65, 82, 84, 63, 32, 40, 121, 47, 110, 41, 32, 32, 32, 32, 32, 32, 32, 10, 0
2165   0D7B 20202020202020202020524553544152543F2028792F6E29202020202020200A
2165   0D9B 00
2166   0D9C 25 75 00    s_3:  db 37, 117, 0
2167   0D9F 2B 0A 00    s_10:  db 43, 10, 0
2168   0DA2             s_9:  db 43, 45, 45, 45, 45, 45, 45, 45, 0
2168   0DA2 2B2D2D2D2D2D2D2D00
2169   0DAB             s_8:  db 50, 48, 52, 56, 46, 99, 32, 37, 49, 55, 100, 32, 112, 116, 115, 10, 10, 0
2169   0DAB 323034382E632025313764207074730A0A00
2170   0DBD             s_1:  db 50, 48, 52, 56, 46, 99, 32, 37, 50, 51, 100, 32, 112, 116, 115, 0
2170   0DBD 323034382E6320253233642070747300
2171   0DCD 7C 0A 00    s_11:  db 124, 10, 0
2172   0DD0             s_6:  db 124, 32, 32, 32, 32, 32, 32, 32, 0
2172   0DD0 7C2020202020202000
2173   0DD9             s_4:  db 124, 37, 42, 115, 37, 115, 37, 42, 115, 0
2173   0DD9 7C252A732573252A7300
2174   0DE3             end: 
2175   0DE3                 savebin 'output.com', begin, end - begin
2176   0DE3             
