;----------------------------------------------------------------------------
; MXOS NC.COM
; Запись слова на ленту
;
; 2013-12-18 Дизассемблировано vinxru
;----------------------------------------------------------------------------

tapeWriteWord:	mov	a, l
		call	tapeWrite
		mov	a, h
		jmp	tapeWrite

;----------------------------------------------------------------------------
; Запись блока данных по адресу HL длиной BC+1 на ленту
;----------------------------------------------------------------------------

tapeWriteBlock:	inx	b
loc_D410:	 call	checkBreak
		 mov	a, m
		 call	tapeWrite
		 inx	h
		 dcx	b
		 mov	a, b
		 ora	c
		jnz	loc_D410
		ret

;----------------------------------------------------------------------------
; Запись пилот тона на ленту
;----------------------------------------------------------------------------

tapeWritePilot:	lxi	b, 200h
loc_D422:	 call	checkBreak
		 xra	a
		 call	tapeWrite
		 dcx	b
		 mov	a, b
		 ora	c
		jnz	loc_D422

		mvi	a, 0E6h
		jmp	tapeWrite

; ---------------------------------------------------------------------------

checkBreak:	lda	IO_KEYB_B
		ana	a
		jp	tapeErrorHandler
		ret